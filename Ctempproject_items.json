{"items":[{"content":{"body":"## Original Request\r\n\r\n> Set up the external OAuth app registrations needed to unblock #18 (social login with Google, Apple, LINE, Kakao). Ticket #18 cannot be implemented without valid OAuth credentials from each provider's developer console.\r\n\r\n## Problem Statement\r\n\r\nTicket #18 (social login integration) is **fully specified and ready to implement**, but it is **soft-blocked** because it requires OAuth application registrations in four external developer consoles. Without valid client IDs and secrets for each provider, the authentication endpoints cannot be built or tested.\r\n\r\nThis is a **manual infrastructure task** â€” someone with account access must register the AI Dev Request application in each provider's developer portal, obtain credentials, and store them securely for use by the backend.\r\n\r\n**Current State:**\r\n- #18 has complete implementation guidance for Google, Apple, LINE, and Kakao OAuth\r\n- BradYoo.Core already supports Google and Kakao OAuth patterns (used in tax-ai)\r\n- Apple Sign-In and LINE Login need new provider registrations\r\n- No OAuth app registrations exist for the AI Dev Request platform\r\n- No credentials are stored in Azure Key Vault or environment config\r\n\r\n## Success Criteria\r\n\r\n- [ ] **Google Cloud Console** â€” OAuth 2.0 client ID created for AI Dev Request\r\n  - Authorized redirect URIs configured for dev + staging + production\r\n  - Client ID and Client Secret obtained\r\n- [ ] **Apple Developer Portal** â€” Sign in with Apple configured\r\n  - App ID registered with Sign in with Apple capability\r\n  - Service ID created with redirect URIs\r\n  - Private key (.p8) generated for token validation\r\n  - Team ID, Key ID, Client ID, and Private Key obtained\r\n- [ ] **LINE Developers Console** â€” LINE Login channel created\r\n  - Channel ID and Channel Secret obtained\r\n  - Callback URLs configured for dev + staging + production\r\n  - Email permission scope requested\r\n- [ ] **Kakao Developers Console** â€” Kakao Login app created\r\n  - REST API Key (Client ID) obtained\r\n  - Redirect URIs configured for dev + staging + production\r\n  - Kakao Login and profile/email consent scopes enabled\r\n- [ ] All credentials stored securely in **Azure Key Vault** (production) and `.env` / `appsettings.Development.json` (local dev)\r\n- [ ] Environment variable mapping documented so #18 implementation can reference them\r\n- [ ] #18 is unblocked and can proceed with implementation\r\n\r\n## Required Accounts & URLs\r\n\r\n| Provider | Developer Console URL | Account Needed |\r\n|----------|----------------------|----------------|\r\n| Google | https://console.cloud.google.com/apis/credentials | Google Cloud account |\r\n| Apple | https://developer.apple.com/account | Apple Developer Program ($99/yr) |\r\n| LINE | https://developers.line.biz/console | LINE Developer account (free) |\r\n| Kakao | https://developers.kakao.com/console | Kakao Developer account (free) |\r\n\r\n## Redirect URI Configuration\r\n\r\nFor each provider, configure these callback URLs:\r\n\r\n```\r\nDevelopment:  http://localhost:5173/auth/callback/{provider}\r\nStaging:      https://staging.aidevrequest.com/auth/callback/{provider}\r\nProduction:   https://aidevrequest.com/auth/callback/{provider}\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Step-by-step for each provider:\r\n\r\n**Google:**\r\n1. Go to Google Cloud Console â†’ APIs & Services â†’ Credentials\r\n2. Create OAuth 2.0 Client ID (Web application type)\r\n3. Add authorized redirect URIs (dev/staging/prod)\r\n4. Copy Client ID and Client Secret\r\n\r\n**Apple:**\r\n1. Go to Apple Developer â†’ Certificates, IDs & Profiles\r\n2. Register a new App ID with \"Sign in with Apple\" capability\r\n3. Create a Services ID (this becomes the Client ID)\r\n4. Configure domains and redirect URLs\r\n5. Create a private key for Sign in with Apple\r\n6. Note: Team ID, Key ID, Services ID, and .p8 private key are all needed\r\n\r\n**LINE:**\r\n1. Go to LINE Developers Console â†’ Create new provider (or use existing)\r\n2. Create a LINE Login channel\r\n3. Set callback URLs\r\n4. Note Channel ID and Channel Secret\r\n5. Request email scope (requires LINE review if not already approved)\r\n\r\n**Kakao:**\r\n1. Go to Kakao Developers â†’ My Applications â†’ Add Application\r\n2. Enable Kakao Login under Product Settings\r\n3. Set redirect URIs\r\n4. Enable consent items: profile, email\r\n5. Note REST API Key\r\n\r\n### Credential Storage:\r\n\r\n```bash\r\n# Azure Key Vault (production)\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"Auth--Google--ClientId\" --value \"<value>\"\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"Auth--Google--ClientSecret\" --value \"<value>\"\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"Auth--Apple--TeamId\" --value \"<value>\"\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"Auth--Apple--KeyId\" --value \"<value>\"\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"Auth--Apple--ClientId\" --value \"<value>\"\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"Auth--Apple--PrivateKey\" --value \"<value>\"\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"Auth--Line--ChannelId\" --value \"<value>\"\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"Auth--Line--ChannelSecret\" --value \"<value>\"\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"Auth--Kakao--ClientId\" --value \"<value>\"\r\n```\r\n\r\n## Out of Scope\r\n\r\n- Implementing the actual OAuth login flows (that's #18)\r\n- Building the login UI or auth middleware\r\n- Geolocation-based provider ordering\r\n- Any code changes â€” this is purely external account setup\r\n- Payment for Apple Developer Program membership (separate procurement)\r\n\r\n## Dependencies\r\n\r\n- **Blocks #18** â€” Social login cannot be implemented without these credentials\r\n- **Apple Developer Program** â€” Requires paid membership ($99/year) â€” may need procurement approval\r\n- **Azure Key Vault** â€” Must exist and be accessible for storing production secrets\r\n- **Domain ownership** â€” Some providers require verified domain ownership for redirect URIs\r\n","number":44,"repository":"bradyoo12/ai-dev-request","title":"infra: set up OAuth app registrations (Google, Apple, LINE, Kakao)","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/44"},"id":"PVTI_lAHNf9fOATn4hM4JP_-X","repository":"https://github.com/bradyoo12/ai-dev-request","status":"Ready","title":"infra: set up OAuth app registrations (Google, Apple, LINE, Kakao)"},{"content":{"body":"## Original Request\r\n\r\n> Set up a domain registrar account with API access to unblock #16 (domain search, purchase, and auto-configuration). Ticket #16 cannot be implemented without a registrar account and API credentials.\r\n\r\n## Problem Statement\r\n\r\nTicket #16 (domain search & purchase for user sites) is **fully specified and ready to implement**, but it is **soft-blocked** because it requires a domain registrar account with programmatic API access. Without a registrar account, the domain search, registration, DNS management, and auto-configuration features cannot be built or tested.\r\n\r\nThis is a **manual infrastructure task** â€” someone must choose a registrar, create an account, enable API access, and store the credentials securely.\r\n\r\n**Current State:**\r\n- #16 has complete implementation guidance for domain search, purchase, and auto-config\r\n- No domain registrar account exists for AI Dev Request\r\n- No registrar API credentials are available\r\n- No DNS management infrastructure is set up\r\n- The recommended registrar is **Cloudflare** (at-cost domain pricing + DNS + API)\r\n\r\n## Success Criteria\r\n\r\n- [ ] Domain registrar account created for AI Dev Request platform\r\n- [ ] API access enabled with appropriate permissions (domain registration, DNS management, availability search)\r\n- [ ] API tokens/keys generated and tested with a simple availability search query\r\n- [ ] Credentials stored securely in **Azure Key Vault** (production) and `.env` / `appsettings.Development.json` (local dev)\r\n- [ ] Registrar billing/payment method configured (domains cost money to register)\r\n- [ ] Test domain search API call verified working (e.g., check availability of `example-test-12345.com`)\r\n- [ ] Environment variable mapping documented so #16 implementation can reference credentials\r\n- [ ] #16 is unblocked and can proceed with implementation\r\n\r\n## Registrar Options\r\n\r\n| Registrar | Pricing | API Quality | Recommendation |\r\n|-----------|---------|-------------|----------------|\r\n| **Cloudflare Registrar** | At-cost (no markup) | Excellent REST API, built-in DNS | **Recommended** â€” cheapest + best API + DNS included |\r\n| Namecheap | Competitive | Good API, well-documented | Good alternative |\r\n| GoDaddy | Higher markup | Decent API | Not recommended (expensive) |\r\n| Google Domains | Competitive | API available | Acceptable alternative |\r\n\r\n### Why Cloudflare is Recommended\r\n\r\n1. **At-cost pricing** â€” Cloudflare charges wholesale ICANN prices with zero markup (e.g., .com = ~$9.15/yr vs $12-15 elsewhere)\r\n2. **Unified DNS** â€” Domain registration + DNS management in one API (no separate DNS provider needed)\r\n3. **Excellent API** â€” Well-documented REST API with domain search, registration, and DNS management\r\n4. **SSL/CDN included** â€” Free SSL, CDN, and DDoS protection for all domains\r\n5. **Auto-renewal** â€” Built-in auto-renewal support via API\r\n\r\n## Implementation Guidance\r\n\r\n### If Using Cloudflare (Recommended):\r\n\r\n1. **Create Cloudflare account** at https://dash.cloudflare.com/sign-up\r\n2. **Add payment method** â€” Credit card or PayPal for domain purchases\r\n3. **Generate API Token:**\r\n   - Go to My Profile â†’ API Tokens â†’ Create Token\r\n   - Use \"Custom Token\" template\r\n   - Permissions needed:\r\n     - `Zone:DNS:Edit` â€” Manage DNS records\r\n     - `Zone:Zone:Read` â€” List zones\r\n     - `Account:Registrar Domains:Edit` â€” Register and manage domains\r\n   - Restrict to AI Dev Request account\r\n4. **Note Account ID** â€” Found on any zone's overview page\r\n5. **Test API access:**\r\n   ```bash\r\n   # Test authentication\r\n   curl -X GET \"https://api.cloudflare.com/client/v4/user/tokens/verify\" \\\r\n     -H \"Authorization: Bearer <API_TOKEN>\"\r\n\r\n   # Test domain availability search\r\n   curl -X GET \"https://api.cloudflare.com/client/v4/accounts/<ACCOUNT_ID>/registrar/domains?query=test-domain-12345\" \\\r\n     -H \"Authorization: Bearer <API_TOKEN>\"\r\n   ```\r\n\r\n### If Using Namecheap (Alternative):\r\n\r\n1. **Create account** at https://www.namecheap.com\r\n2. **Enable API access** â€” Contact support or use sandbox first\r\n3. **Whitelist server IP** â€” Namecheap requires IP whitelisting for API\r\n4. **API credentials:** API User + API Key\r\n\r\n### Credential Storage:\r\n\r\n```bash\r\n# Azure Key Vault (production)\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"DomainRegistrar--Provider\" --value \"cloudflare\"\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"DomainRegistrar--ApiToken\" --value \"<value>\"\r\naz keyvault secret set --vault-name aidevrequest-kv --name \"DomainRegistrar--AccountId\" --value \"<value>\"\r\n\r\n# Local development (.env or appsettings.Development.json)\r\n# DomainRegistrar__Provider=cloudflare\r\n# DomainRegistrar__ApiToken=<value>\r\n# DomainRegistrar__AccountId=<value>\r\n```\r\n\r\n### Configuration Mapping:\r\n\r\n```json\r\n// appsettings.json structure\r\n{\r\n  \"DomainRegistrar\": {\r\n    \"Provider\": \"cloudflare\",\r\n    \"ApiToken\": \"<from-keyvault>\",\r\n    \"AccountId\": \"<from-keyvault>\",\r\n    \"SupportedTlds\": [\"com\", \"net\", \"io\", \"dev\", \"app\", \"kr\", \"co.kr\"],\r\n    \"AutoRenew\": true\r\n  }\r\n}\r\n```\r\n\r\n## Out of Scope\r\n\r\n- Implementing the domain search/purchase API endpoints (that's #16)\r\n- Building the domain management UI\r\n- Azure Container Apps custom domain binding\r\n- SSL certificate provisioning logic\r\n- Domain pricing strategy or markup decisions\r\n- Registering any actual production domains (just account setup)\r\n\r\n## Dependencies\r\n\r\n- **Blocks #16** â€” Domain features cannot be implemented without registrar API access\r\n- **Payment method** â€” Credit card needed for the registrar account (domains cost money)\r\n- **Azure Key Vault** â€” Must exist and be accessible for storing production secrets\r\n- **Server IP** â€” If using Namecheap, the production server IP must be known for API whitelisting\r\n","number":45,"repository":"bradyoo12/ai-dev-request","title":"infra: set up domain registrar account (Cloudflare recommended)","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/45"},"id":"PVTI_lAHNf9fOATn4hM4JP_-d","repository":"https://github.com/bradyoo12/ai-dev-request","status":"Ready","title":"infra: set up domain registrar account (Cloudflare recommended)"},{"content":{"body":"## Original Request\n\n> fix errors\n\n## Problem Statement\n\nThe staging site (`https://icy-desert-07c08ba00.2.azurestaticapps.net`) is completely broken â€” all text shows raw i18n keys instead of translated content, and the backend API (`https://ai-dev-request-api.azurewebsites.net`) returns HTTP 500 on every endpoint.\n\n### Observed Errors (from browser console)\n\n| Endpoint | Status | Impact |\n|----------|--------|--------|\n| `/api/translations/en-AU` | 500 | English translations fail to load |\n| `/api/translations/ko` | 500 | Korean translations fail to load |\n| `/api/languages` | 500 | Language list fails to load |\n| `/api/settings/tokens` | 500 | Token balance fails to load |\n| `index-CiMJBUIK.css` | 404 | Stylesheet missing |\n\n### Visible Symptoms\n\n- All UI text shows raw i18n keys: `hero.title`, `header.mySites`, `form.label`, `steps.request.title`, etc.\n- Navigation shows: `header.mySites`, `header.pricing`, `header.settings`, `header.contact`\n- Pricing section shows: `pricing.title`, `pricing.perMonth`, `pricing.starter.projects`\n- No token balance displayed in header\n\n### Root Cause (Likely)\n\nThe backend API is returning 500 on all database-dependent endpoints. Recent PRs added new entities (`User`, `AutoTopUpConfig`, `HostingPlan`, `BuildVerification`) that require database schema changes. The staging PostgreSQL database likely hasn't been migrated to include these new tables, causing EF Core to throw on startup or on first query.\n\nThe `auto-migrate` code in `Program.cs` uses `EnsureCreatedAsync()` which only works for new databases â€” it does NOT apply incremental schema changes to existing databases. This means every new entity addition silently breaks staging.\n\n## Success Criteria\n\n- [ ] All backend API endpoints return 200 (not 500) on staging\n- [ ] Frontend displays translated text (not raw i18n keys) on staging\n- [ ] Token balance loads in header\n- [ ] Translations load for both `ko` and `en` languages\n- [ ] CSS stylesheet loads (no 404)\n- [ ] Playwright staging tests pass: `npm run test:staging` (at least 11/11 non-skipped tests pass)\n\n## Implementation Guidance\n\n### Option A: Add EF Core Migrations (Recommended)\n1. Replace `EnsureCreatedAsync()` with proper EF Core migrations\n2. Add migration for all current entities\n3. Run `dotnet ef database update` against staging DB\n4. Add migration step to CI/CD deploy pipeline\n\n### Option B: Quick Fix â€” Recreate Database\n1. Drop and recreate the staging database\n2. Let `EnsureCreatedAsync()` create fresh schema with all current entities\n3. Re-seed initial data (languages, token packages, pricing, hosting plans)\n\n### CSS 404 Fix\n- Verify the Azure Static Web Apps deployment includes the built CSS with correct hash filenames\n- Check if `staticwebapp.config.json` needs MIME type rules for `.css` files\n\n## Out of Scope\n\n- Adding new features or entities\n- Changing the authentication system\n- Production database changes (staging only)\n\n## Dependencies\n\n- Requires access to Azure staging database connection string\n- Related to recent PRs that added new entities: #34 (auth), #36 (unused import fix), #38 (deploy fix), #39 (build verification)\n","number":41,"repository":"bradyoo12/ai-dev-request","title":"fix: staging backend 500 errors and broken i18n translations","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/41"},"id":"PVTI_lAHNf9fOATn4hM4JP_u7","linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/46"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"fix: staging backend 500 errors and broken i18n translations"},{"content":{"body":"## Summary\r\n\r\nAfter the initial build is complete, allow users to iteratively refine their generated project through a chat interface â€” requesting changes, adding features, or fixing issues conversationally. This transforms the current one-shot flow into an ongoing collaboration.\r\n\r\n## Problem\r\n\r\nOur current pipeline is strictly linear: Request â†’ Analysis â†’ Proposal â†’ Build â†’ Download. Once a project is generated, the user has no way to refine it through the platform. They must either submit an entirely new request or manually edit the code themselves.\r\n\r\nAll major competitors (Bolt.new, v0.dev, Replit, Lovable) offer **conversational refinement** â€” users chat with the AI to iterate on the generated output. This is now table stakes for AI app builders.\r\n\r\n## Proposed Solution\r\n\r\nAdd a **post-build chat refinement** phase:\r\n\r\n1. After build completes, show a chat interface alongside the project files\r\n2. User describes desired changes in natural language (e.g., \"Change the header color to blue\", \"Add a contact form to the homepage\")\r\n3. AI analyzes the existing project files + user request\r\n4. AI generates targeted code changes (not full regeneration)\r\n5. Updated project delivered with diff view showing what changed\r\n\r\n### User Flow\r\n\r\n```\r\nCurrent:  Request â†’ Analysis â†’ Proposal â†’ Build â†’ Download (done)\r\n\r\nProposed: Request â†’ Analysis â†’ Proposal â†’ Build â†’ Chat Refinement â†» â†’ Download\r\n                                                    â”‚\r\n                                                    â”œâ”€ \"Add dark mode\"\r\n                                                    â”œâ”€ \"Change the logo\"\r\n                                                    â”œâ”€ \"Add user login page\"\r\n                                                    â””â”€ \"Fix the mobile layout\"\r\n```\r\n\r\n### Token Cost Model\r\n- Each refinement iteration costs tokens (similar to analysis cost)\r\n- Small changes (styling, text): 5-10 tokens\r\n- Medium changes (new component): 15-25 tokens\r\n- Large changes (new feature): 30-50 tokens\r\n- Token cost shown before each refinement\r\n\r\n### Key Components\r\n- **Chat UI**: Conversation interface within the project view page\r\n- **Context loader**: Reads existing project files to give AI full context\r\n- **Diff generator**: Shows what changed between iterations\r\n- **Scoped changes**: AI modifies only relevant files, not full regeneration\r\n\r\n## Competitive Context\r\n\r\n| Platform | Post-Build Refinement? | Approach |\r\n|----------|----------------------|----------|\r\n| Bolt.new | Yes | Chat in browser IDE, live preview |\r\n| v0.dev | Yes | Conversational component refinement |\r\n| Replit | Yes | Agent chat in workspace |\r\n| Lovable | Yes | Real-time collaborative refinement |\r\n| **AI Dev Request** | **No (proposed)** | **Chat refinement with token-based pricing** |\r\n\r\n## Impact\r\n\r\n- **Retention**: Users stay on platform longer instead of leaving after download\r\n- **Revenue**: Additional token consumption per refinement cycle\r\n- **Satisfaction**: Users get exactly what they want through iteration\r\n- **Competitive parity**: This is now expected by users of AI builders\r\n\r\n## References\r\n\r\n- [V0 vs Bolt.new vs Lovable Comparison](https://www.nxcode.io/resources/news/v0-vs-bolt-vs-lovable-ai-app-builder-comparison-2025)\r\n- [Bolt.new Overview](https://www.prismetric.com/what-is-bolt-ai/)\r\n- [v0.dev FAQ](https://v0.dev/faq)\r\n","number":27,"repository":"bradyoo12/ai-dev-request","title":"feat: Post-build conversational refinement chat for iterative project changes","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/27"},"id":"PVTI_lAHNf9fOATn4hM4JPmSE","labels":["suggestion"],"linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/40"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: Post-build conversational refinement chat for iterative project changes"},{"content":{"body":"## Original Request\r\n\r\n> Create a simpler auth ticket that doesn't require external OAuth provider setup, to unblock downstream tickets (#21 billing, #23 hosting plans) that are blocked by #18 (social login).\r\n\r\n## Problem Statement\r\n\r\nAll downstream tickets (#21 billing, #23 hosting plans) are blocked by #18 (social login), which requires external OAuth app registrations (Google, Apple, LINE, Kakao developer consoles). This creates a pipeline bottleneck.\r\n\r\nThe platform currently uses **anonymous UUID-based identification** â€” a random UUID is generated in `localStorage` and sent via `X-User-Id` header on every request. There is no real authentication, no password, no user entity, and no way to recover an account if `localStorage` is cleared.\r\n\r\n**Current anonymous auth pattern:**\r\n- Frontend: `getUserId()` in `settings.ts` generates UUID, stores in `localStorage('ai-dev-user-id')`\r\n- Backend: Every controller has `GetUserId()` extracting `X-User-Id` header (falls back to `\"anonymous\"`)\r\n- Entities using UserId: `TokenBalance`, `TokenTransaction`, `Payment`, `Deployment`\r\n\r\nThe platform needs a real auth system that can be implemented **without external dependencies**, unblocking the pipeline while #18 remains a future enhancement for social login.\r\n\r\n## Success Criteria\r\n\r\n- [ ] New `User` entity with email, password hash, and display name\r\n- [ ] Users can register with email + password via `POST /api/auth/register`\r\n- [ ] Users can log in and receive a JWT via `POST /api/auth/login`\r\n- [ ] JWT is sent in `Authorization: Bearer` header for authenticated requests\r\n- [ ] `GET /api/auth/me` returns current user info from JWT claims\r\n- [ ] Auth middleware validates JWT on protected endpoints\r\n- [ ] Backward compatible: anonymous UUID users still work (gradual migration)\r\n- [ ] On registration, existing UUID data (tokens, payments, deployments) migrates to the new account\r\n- [ ] Login/Register page with form validation (email format, password min 8 chars)\r\n- [ ] Header shows user email when logged in, with logout button\r\n- [ ] Password stored as BCrypt hash (never plain text)\r\n- [ ] Frontend stores JWT in localStorage and includes in all API calls\r\n\r\n## Visual Mockups\r\n\r\n### Login/Register Page\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚                                                             â”‚\r\nâ”‚              ğŸš€ AI Dev Request                              â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚           Turn your ideas into reality                      â”‚\r\nâ”‚         Sign in to start building your project              â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  Email                               â”‚             â”‚\r\nâ”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚             â”‚\r\nâ”‚         â”‚  â”‚ user@example.com                â”‚ â”‚             â”‚\r\nâ”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚             â”‚\r\nâ”‚         â”‚                                      â”‚             â”‚\r\nâ”‚         â”‚  Password                            â”‚             â”‚\r\nâ”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚             â”‚\r\nâ”‚         â”‚  â”‚ â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢                      â”‚ â”‚             â”‚\r\nâ”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚             â”‚\r\nâ”‚         â”‚                                      â”‚             â”‚\r\nâ”‚         â”‚  [        Sign In        ]           â”‚             â”‚\r\nâ”‚         â”‚                                      â”‚             â”‚\r\nâ”‚         â”‚  Don't have an account? Register     â”‚             â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚         Or continue without an account                      â”‚\r\nâ”‚         (limited features, data may be lost)                â”‚\r\nâ”‚                                                             â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Register Form (toggled)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  Display Name                        â”‚             â”‚\r\nâ”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚             â”‚\r\nâ”‚         â”‚  â”‚ Brady Yoo                       â”‚ â”‚             â”‚\r\nâ”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚             â”‚\r\nâ”‚         â”‚                                      â”‚             â”‚\r\nâ”‚         â”‚  Email                               â”‚             â”‚\r\nâ”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚             â”‚\r\nâ”‚         â”‚  â”‚ brady@example.com               â”‚ â”‚             â”‚\r\nâ”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚             â”‚\r\nâ”‚         â”‚                                      â”‚             â”‚\r\nâ”‚         â”‚  Password (min 8 characters)         â”‚             â”‚\r\nâ”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚             â”‚\r\nâ”‚         â”‚  â”‚ â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢                      â”‚ â”‚             â”‚\r\nâ”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚             â”‚\r\nâ”‚         â”‚                                      â”‚             â”‚\r\nâ”‚         â”‚  â˜‘ Migrate my existing token balance â”‚             â”‚\r\nâ”‚         â”‚    and project data to this account  â”‚             â”‚\r\nâ”‚         â”‚                                      â”‚             â”‚\r\nâ”‚         â”‚  [       Create Account      ]       â”‚             â”‚\r\nâ”‚         â”‚                                      â”‚             â”‚\r\nâ”‚         â”‚  Already have an account? Sign in    â”‚             â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Header â€” Authenticated State\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  ğŸš€ AI Dev Request     My Sites  Pricing  Settings          â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚                        ğŸª™ 743 tokens    brady@ex.. [â–¾]      â”‚\r\nâ”‚                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\r\nâ”‚                                         â”‚ âš™ï¸ Settings   â”‚    â”‚\r\nâ”‚                                         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚    â”‚\r\nâ”‚                                         â”‚ ğŸšª Log Out   â”‚    â”‚\r\nâ”‚                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Header â€” Anonymous State (current, preserved)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  ğŸš€ AI Dev Request     My Sites  Pricing  Settings  Sign In â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚                        ğŸª™ 1,000 tokens                      â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Backend â€” New Entity\r\n\r\n**`Entities/User.cs`**\r\n```\r\nUser:\r\n  Id (Guid, PK)\r\n  Email (string, unique, required, max 255)\r\n  PasswordHash (string, required)\r\n  DisplayName (string?, max 100)\r\n  AnonymousUserId (string?, max 100) â€” links to previous UUID for migration\r\n  CreatedAt (DateTime)\r\n  UpdatedAt (DateTime)\r\n  LastLoginAt (DateTime?)\r\n```\r\n\r\n### Backend â€” New Service\r\n\r\n**`Services/AuthService.cs`** â€” `IAuthService`\r\n- `RegisterAsync(email, password, displayName?, anonymousUserId?)` â€” Create user, hash password, migrate data\r\n- `LoginAsync(email, password)` â€” Validate credentials, return JWT\r\n- `GetUserAsync(userId)` â€” Get user by ID\r\n- `GenerateJwt(user)` â€” Create JWT with claims (sub, email, name)\r\n- `MigrateAnonymousDataAsync(anonymousUserId, newUserId)` â€” Update all entities' UserId\r\n\r\n**Password hashing**: BCrypt via `BCrypt.Net-Next` NuGet package\r\n**JWT config**: Read secret from `appsettings.json` under `Jwt:Secret`, `Jwt:Issuer`, `Jwt:ExpiryDays`\r\n\r\n### Backend â€” New Controller\r\n\r\n**`Controllers/AuthController.cs`**\r\n- `POST /api/auth/register` â€” `{ email, password, displayName?, anonymousUserId? }` â†’ `{ token, user }`\r\n- `POST /api/auth/login` â€” `{ email, password }` â†’ `{ token, user }`\r\n- `GET /api/auth/me` â€” `[Authorize]` â†’ `{ id, email, displayName, createdAt }`\r\n\r\n### Backend â€” Middleware Updates\r\n\r\n**`Program.cs`** additions:\r\n```csharp\r\n// Add JWT authentication\r\nbuilder.Services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)\r\n    .AddJwtBearer(options => { /* configure from appsettings */ });\r\n\r\n// Add auth service\r\nbuilder.Services.AddScoped<IAuthService, AuthService>();\r\n\r\n// In pipeline:\r\napp.UseAuthentication();\r\napp.UseAuthorization();\r\n```\r\n\r\n**Controller compatibility**: Keep `GetUserId()` working â€” check JWT claims first, fall back to `X-User-Id` header:\r\n```csharp\r\nprivate string GetUserId()\r\n{\r\n    var jwtUserId = User.FindFirst(ClaimTypes.NameIdentifier)?.Value;\r\n    if (!string.IsNullOrEmpty(jwtUserId)) return jwtUserId;\r\n    return Request.Headers[\"X-User-Id\"].FirstOrDefault() ?? \"anonymous\";\r\n}\r\n```\r\n\r\n### Backend â€” NuGet Packages\r\n- `BCrypt.Net-Next` â€” Password hashing\r\n- `Microsoft.AspNetCore.Authentication.JwtBearer` â€” JWT middleware\r\n\r\n### Frontend â€” Auth API\r\n\r\n**`src/api/auth.ts`**\r\n- `register(email, password, displayName?, anonymousUserId?)` â†’ `{ token, user }`\r\n- `login(email, password)` â†’ `{ token, user }`\r\n- `getMe()` â†’ `{ id, email, displayName }`\r\n- `logout()` â€” Clear stored token\r\n- Store JWT in `localStorage('ai-dev-jwt')`\r\n- Update `authHeaders()` to prefer JWT over UUID\r\n\r\n### Frontend â€” Login Page\r\n\r\n**`src/pages/LoginPage.tsx`**\r\n- Toggle between login/register forms\r\n- Form validation (email format, password min 8 chars)\r\n- On register: include current UUID from `localStorage('ai-dev-user-id')` for migration\r\n- Error display for failed login/duplicate email\r\n- \"Continue without account\" link for anonymous usage\r\n\r\n### Frontend â€” App.tsx Updates\r\n- Add `'login'` to `PageState` type\r\n- Show \"Sign In\" button in header when not authenticated\r\n- Show user email + dropdown menu when authenticated\r\n- Store auth state (JWT + user info) in state\r\n\r\n### Data Migration Strategy\r\n\r\nWhen a user registers with an existing `anonymousUserId`:\r\n1. Create User entity with `AnonymousUserId = uuid`\r\n2. Update `TokenBalance.UserId` from old UUID to new user GUID\r\n3. Update `TokenTransaction.UserId` for all matching records\r\n4. Update `Payment.UserId` for all matching records\r\n5. Update `Deployment.UserId` for all matching records\r\n6. All done in a single transaction\r\n\r\n## Out of Scope\r\n\r\n- Social login / OAuth (covered by #18 as a future enhancement)\r\n- Email verification / password reset flows\r\n- Two-factor authentication (2FA)\r\n- Role-based authorization (admin vs user)\r\n- Account deletion / GDPR data export\r\n- Session management beyond JWT expiry\r\n\r\n## Dependencies\r\n\r\n**None** â€” fully self-contained within ai-dev-request. No external services needed.\r\n\r\n**Unblocks:**\r\n- #21 (billing settings) â€” needs real user identity for saved cards\r\n- #23 (Azure hosting plan) â€” needs user context for billing\r\n\r\n**Relationship to #18:**\r\nThis ticket provides a minimal auth foundation. #18 (social login) can later add OAuth providers as additional login methods alongside email/password, using the same User entity and JWT infrastructure.\r\n","number":33,"repository":"bradyoo12/ai-dev-request","title":"feat: Simple email/password authentication with JWT","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/33"},"id":"PVTI_lAHNf9fOATn4hM4JPpmk","linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/34"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: Simple email/password authentication with JWT"},{"content":{"body":"## Original Request\r\n\r\n> This site should support multi language. On admin page, admin should be able to add languages that can be selected by users.\r\n\r\n## Problem Statement\r\n\r\nThe platform currently has all UI text hardcoded in Korean with no internationalization (i18n) framework. There is no way for users to switch languages, and no admin interface exists to manage supported languages. To reach a global audience, the platform needs a proper multi-language system with admin-managed language configuration.\r\n\r\n**Current State:**\r\n- All UI strings are hardcoded Korean in `App.tsx`\r\n- Currency formatting uses `Intl.NumberFormat('ko-KR')`\r\n- No i18n library installed\r\n- No admin pages or admin authentication exist\r\n- No language/translation database tables\r\n\r\n## Success Criteria\r\n\r\n- [ ] An i18n framework (e.g., `react-i18next`) is integrated into the frontend\r\n- [ ] All hardcoded Korean strings are extracted into translation resource files\r\n- [ ] Korean (ko) is set as the default language\r\n- [ ] Users can select their preferred language from a dropdown/selector in the UI\r\n- [ ] Admin page exists where admins can add/remove supported languages\r\n- [ ] Admin can upload or edit translation key-value pairs per language\r\n- [ ] Language preference persists across sessions (localStorage or user profile)\r\n- [ ] The backend serves and stores translation data (languages table, translations table)\r\n- [ ] Newly added languages appear in the user-facing language selector\r\n- [ ] Date, number, and currency formatting respect the selected locale\r\n\r\n## Visual Mockups\r\n\r\n### User Language Selector (Header)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  ğŸ—ï¸ AI Dev Request                          [ğŸŒ í•œêµ­ì–´ â–¾]  â”‚\r\nâ”‚                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\r\nâ”‚                                              â”‚ í•œêµ­ì–´  âœ“ â”‚  â”‚\r\nâ”‚                                              â”‚ English   â”‚  â”‚\r\nâ”‚                                              â”‚ æ—¥æœ¬èª    â”‚  â”‚\r\nâ”‚                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\r\nâ”‚  â”‚          ì•„ì´ë””ì–´ë§Œ ìˆìœ¼ë©´ ë©ë‹ˆë‹¤                       â”‚  â”‚\r\nâ”‚  â”‚    (text changes based on selected language)           â”‚  â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Admin - Language Management Page\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Admin > Language Management                                â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                             â”‚\r\nâ”‚  Supported Languages                     [+ Add Language]   â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚\r\nâ”‚  â”‚ Code â”‚ Name     â”‚ Status  â”‚ Progress â”‚ Actions        â”‚  â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚\r\nâ”‚  â”‚ ko   â”‚ í•œêµ­ì–´   â”‚ Default â”‚ 100%     â”‚ [Edit]         â”‚  â”‚\r\nâ”‚  â”‚ en   â”‚ English  â”‚ Active  â”‚  85%     â”‚ [Edit] [ğŸ—‘ï¸]   â”‚  â”‚\r\nâ”‚  â”‚ ja   â”‚ æ—¥æœ¬èª   â”‚ Draft   â”‚  40%     â”‚ [Edit] [ğŸ—‘ï¸]   â”‚  â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ”‚                                                             â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Admin - Translation Editor\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Admin > Language Management > English (en)                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                             â”‚\r\nâ”‚  [Import JSON]  [Export JSON]          Progress: 85%        â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚\r\nâ”‚  Filter: [________________] [All â–¾] [Missing only â˜]       â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚\r\nâ”‚  â”‚ Key                â”‚ Korean (ref)      â”‚ English        â”‚ â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚\r\nâ”‚  â”‚ hero.title         â”‚ ì•„ì´ë””ì–´ë§Œ ìˆìœ¼ë©´ â”‚ Just bring     â”‚ â”‚\r\nâ”‚  â”‚                    â”‚ ë©ë‹ˆë‹¤            â”‚ your idea      â”‚ â”‚\r\nâ”‚  â”‚ hero.subtitle      â”‚ AIê°€ ë¶„ì„í•˜ê³ ...  â”‚ AI analyzes... â”‚ â”‚\r\nâ”‚  â”‚ form.description   â”‚ ì–´ë–¤ ì„œë¹„ìŠ¤ë¥¼...  â”‚ What service.. â”‚ â”‚\r\nâ”‚  â”‚ form.submit        â”‚ ë¬´ë£Œë¡œ ë¶„ì„ë°›ê¸°   â”‚ Get Free...    â”‚ â”‚\r\nâ”‚  â”‚ pricing.free       â”‚ ë¬´ë£Œ              â”‚ Free           â”‚ â”‚\r\nâ”‚  â”‚ pricing.starter    â”‚ ìŠ¤íƒ€í„°            â”‚ âš ï¸ (missing)   â”‚ â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚  [Save Changes]                                             â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Admin - Add Language Dialog\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Add New Language                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                   â”‚\r\nâ”‚  Language Code:  [en________]     â”‚\r\nâ”‚  Language Name:  [English___]     â”‚\r\nâ”‚  Native Name:   [English___]     â”‚\r\nâ”‚                                   â”‚\r\nâ”‚  Initialize from:                 â”‚\r\nâ”‚  â—‹ Empty (start from scratch)     â”‚\r\nâ”‚  â— Copy from: [í•œêµ­ì–´ â–¾]          â”‚\r\nâ”‚  â—‹ Import JSON file               â”‚\r\nâ”‚                                   â”‚\r\nâ”‚         [Cancel]  [Add Language]   â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Frontend\r\n- Integrate `react-i18next` with `i18next-http-backend` to load translations from API\r\n- Extract all hardcoded Korean strings into a `ko.json` resource file as the baseline\r\n- Add a `LanguageSelector` component in the header/navbar\r\n- Store user language preference in `localStorage` and send as `Accept-Language` header\r\n- Use namespace-based translation keys (e.g., `hero.title`, `form.submit`, `pricing.free`)\r\n\r\n### Backend\r\n- Add `Language` entity (code, name, nativeName, isDefault, isActive, createdAt)\r\n- Add `Translation` entity (languageCode, key, value, namespace)\r\n- Create `LanguagesController` with CRUD endpoints for admin\r\n- Create `TranslationsController` for serving translations to frontend and admin editing\r\n- API endpoints: `GET /api/languages`, `GET /api/translations/{locale}`, `POST /api/admin/languages`, `PUT /api/admin/translations/{locale}`\r\n\r\n### Admin\r\n- Admin page requires admin role authentication (coordinate with auth system)\r\n- Language management page with CRUD operations\r\n- Translation editor with reference language display, missing key highlighting, and progress tracking\r\n- Support JSON import/export for bulk translation management\r\n\r\n### Database Schema (New Tables)\r\n```\r\nlanguages:       id, code, name, native_name, is_default, is_active, created_at, updated_at\r\ntranslations:    id, language_code, namespace, key, value, created_at, updated_at\r\n```\r\n\r\n## Out of Scope\r\n\r\n- Machine translation / auto-translate integration (future enhancement)\r\n- Right-to-left (RTL) language layout support (can be added later)\r\n- Per-user language preference stored in user profile (use localStorage for now)\r\n- Pluralization rules beyond what i18next provides by default\r\n- AI-generated content translation (chat responses, analysis results remain in original language)\r\n\r\n## Dependencies\r\n\r\n- Admin authentication/authorization system (needs admin role concept)\r\n- Frontend component decomposition (current single App.tsx makes extraction harder)\r\n\r\n## Labels\r\n\r\n`feature`, `frontend`, `backend`, `i18n`\r\n","number":9,"repository":"bradyoo12/ai-dev-request","title":"feat: multi-language support with admin language management","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/9"},"id":"PVTI_lAHNf9fOATn4hM4JPgs5","repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: multi-language support with admin language management"},{"content":{"body":"## Original Request\r\n\r\n> Add setting page for service pricing. Each new user will be given free 1000 tokens that is worth $10.\r\n\r\n## Problem Statement\r\n\r\nThe platform currently has no user-facing settings page and no token/credit-based pricing system. While pricing tiers (Free, Starter, Pro, Enterprise) and a `Subscription` entity exist in code, they are project-limit-based (not token-based) and the Subscription entity is not even registered in the DbContext.\r\n\r\nThe platform needs to shift to a **token-based consumption model** where:\r\n- Each new user receives **1,000 free tokens (worth $10)** upon registration\r\n- Users consume tokens when using AI services (analysis, proposal generation, builds)\r\n- A **Settings page** lets users view their token balance, usage history, and purchase more tokens\r\n- Pricing is transparent with clear token costs per action\r\n\r\n**Current State:**\r\n- Pricing tiers exist but are project-limit-based, not token-based\r\n- `Subscription` entity is defined but not registered in `AiDevRequestDbContext`\r\n- No user settings page exists\r\n- No token/credit/balance system exists\r\n- No usage tracking or metering\r\n\r\n## Success Criteria\r\n\r\n- [ ] New users automatically receive 1,000 free tokens ($10 value) on account creation\r\n- [ ] Token balance is tracked per user and decremented on AI service usage\r\n- [ ] Settings page displays current token balance, usage history, and pricing info\r\n- [ ] Settings page shows token cost breakdown per action type (analysis, proposal, build)\r\n- [ ] Users can see how many tokens each action will cost before confirming\r\n- [ ] Token purchase/top-up flow is available from the settings page\r\n- [ ] Backend enforces token balance checks before executing paid actions\r\n- [ ] Insufficient balance returns a clear error with a link to purchase tokens\r\n- [ ] Token transaction history is persisted (credits, debits, purchases)\r\n- [ ] Admin can configure token pricing (cost per action, token packages)\r\n\r\n## Visual Mockups\r\n\r\n### Settings Page - Token Overview\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  AI Dev Request          [Dashboard]  [Settings]  [user@email]  â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  Settings > Token Balance                                       â”‚\r\nâ”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚\r\nâ”‚  â”‚  Token Balance       â”‚  â”‚  Total Used          â”‚              â”‚\r\nâ”‚  â”‚                      â”‚  â”‚                      â”‚              â”‚\r\nâ”‚  â”‚  ğŸª™ 743 tokens       â”‚  â”‚  257 tokens          â”‚              â”‚\r\nâ”‚  â”‚  â‰ˆ $7.43 value       â”‚  â”‚  since signup         â”‚              â”‚\r\nâ”‚  â”‚                      â”‚  â”‚                      â”‚              â”‚\r\nâ”‚  â”‚  [+ Buy Tokens]      â”‚  â”‚  [View History]      â”‚              â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Token Pricing                                                  â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  â”‚ Action             â”‚ Token Cost â”‚ Approx USD â”‚               â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚\r\nâ”‚  â”‚ AI Analysis         â”‚ 50 tokens  â”‚ $0.50      â”‚              â”‚\r\nâ”‚  â”‚ Proposal Generation â”‚ 100 tokens â”‚ $1.00      â”‚              â”‚\r\nâ”‚  â”‚ Project Build       â”‚ 300 tokens â”‚ $3.00      â”‚              â”‚\r\nâ”‚  â”‚ Staging Deploy      â”‚ 50 tokens  â”‚ $0.50      â”‚              â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Settings Page - Usage History\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Settings > Token Balance > Usage History                       â”‚\r\nâ”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Filter: [All Types â–¾]  [Last 30 days â–¾]                       â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  â”‚ Date       â”‚ Action              â”‚ Tokens â”‚ Balance â”‚        â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚\r\nâ”‚  â”‚ 2026-02-06 â”‚ AI Analysis         â”‚ -50    â”‚ 743     â”‚        â”‚\r\nâ”‚  â”‚ 2026-02-05 â”‚ Proposal Generation â”‚ -100   â”‚ 793     â”‚        â”‚\r\nâ”‚  â”‚ 2026-02-05 â”‚ AI Analysis         â”‚ -50    â”‚ 893     â”‚        â”‚\r\nâ”‚  â”‚ 2026-02-03 â”‚ Token Purchase      â”‚ +500   â”‚ 943     â”‚        â”‚\r\nâ”‚  â”‚ 2026-02-01 â”‚ AI Analysis         â”‚ -57    â”‚ 443     â”‚        â”‚\r\nâ”‚  â”‚ 2026-01-28 â”‚ ğŸ Welcome Bonus   â”‚ +1000  â”‚ 1000    â”‚        â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  [Load More...]                                                 â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Buy Tokens Dialog\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Buy Tokens                             â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                         â”‚\r\nâ”‚  Current Balance: ğŸª™ 743 tokens         â”‚\r\nâ”‚                                         â”‚\r\nâ”‚  Select a package:                      â”‚\r\nâ”‚                                         â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\r\nâ”‚  â”‚  500 tokens         $5.00      â”‚    â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\r\nâ”‚  â”‚  1,000 tokens       $10.00  â­  â”‚    â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\r\nâ”‚  â”‚  3,000 tokens       $25.00     â”‚    â”‚\r\nâ”‚  â”‚  (save 17%)                    â”‚    â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\r\nâ”‚  â”‚  10,000 tokens      $70.00     â”‚    â”‚\r\nâ”‚  â”‚  (save 30%)                    â”‚    â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\r\nâ”‚                                         â”‚\r\nâ”‚            [Cancel]  [Purchase]          â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Token Cost Confirmation (Before Action)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Confirm Action                       â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                       â”‚\r\nâ”‚  AI Analysis will use:                â”‚\r\nâ”‚                                       â”‚\r\nâ”‚     ğŸª™ 50 tokens ($0.50)             â”‚\r\nâ”‚                                       â”‚\r\nâ”‚  Remaining balance: 693 tokens        â”‚\r\nâ”‚                                       â”‚\r\nâ”‚         [Cancel]  [Confirm]           â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Insufficient Balance Error\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  âš ï¸ Insufficient Tokens               â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                       â”‚\r\nâ”‚  This action requires 300 tokens      â”‚\r\nâ”‚  Your balance: ğŸª™ 143 tokens          â”‚\r\nâ”‚                                       â”‚\r\nâ”‚  You need 157 more tokens.            â”‚\r\nâ”‚                                       â”‚\r\nâ”‚        [Cancel]  [Buy Tokens]         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Backend\r\n\r\n**New Entities:**\r\n```\r\nTokenBalance:     user_id, balance, total_earned, total_spent, created_at, updated_at\r\nTokenTransaction: id, user_id, type (credit/debit), amount, action (welcome_bonus/analysis/\r\n                  proposal/build/purchase), reference_id, description, balance_after, created_at\r\nTokenPackage:     id, name, token_amount, price_usd, discount_percent, is_active, sort_order\r\nTokenPricing:     id, action_type, token_cost, description, is_active\r\n```\r\n\r\n**Key Logic:**\r\n- On user creation â†’ insert `TokenBalance` with 1,000 tokens and a `TokenTransaction` (type: credit, action: welcome_bonus)\r\n- Before any AI action â†’ check balance >= cost; reject with 402/403 if insufficient\r\n- After AI action completes â†’ debit tokens atomically and record transaction\r\n- Use database transactions to prevent race conditions on balance updates\r\n\r\n**New Endpoints:**\r\n- `GET /api/settings/tokens` â€” current balance and pricing info\r\n- `GET /api/settings/tokens/history` â€” paginated transaction history\r\n- `GET /api/settings/tokens/packages` â€” available purchase packages\r\n- `POST /api/settings/tokens/purchase` â€” buy a token package\r\n- `GET /api/pricing/token-costs` â€” public token cost per action\r\n\r\n### Frontend\r\n\r\n- Add a **Settings** navigation item in the header\r\n- Create a `/settings` route (will need React Router or extend the view state machine)\r\n- Build `TokenBalance`, `UsageHistory`, `BuyTokens` components\r\n- Show token cost confirmation dialog before AI actions (analyze, proposal, build)\r\n- Show insufficient balance error with link to purchase when balance is too low\r\n- Display current token balance in the header for quick reference\r\n\r\n### Migration from Project-Limit Model\r\n\r\nThe current `Subscription` entity uses project limits. This ticket introduces a parallel **token-based consumption model**. The two can coexist:\r\n- Subscription tiers can optionally include monthly token allowances\r\n- Or the platform can fully migrate to token-only pricing (decision needed)\r\n\r\n## Out of Scope\r\n\r\n- Payment gateway integration (Stripe, etc.) â€” separate ticket for actual payment processing\r\n- Subscription tier auto-renewal or recurring billing\r\n- Token expiration policies\r\n- Referral/promotional token bonuses beyond the welcome bonus\r\n- Enterprise custom token pricing negotiations\r\n- Refund logic for unused tokens\r\n\r\n## Dependencies\r\n\r\n- User authentication system (need user accounts to track token balances)\r\n- #9 Multi-language support (settings page text should be translatable)\r\n","number":13,"repository":"bradyoo12/ai-dev-request","title":"feat: add settings page with token-based pricing (1,000 free tokens for new users)","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/13"},"id":"PVTI_lAHNf9fOATn4hM4JPhXi","linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/22"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: add settings page with token-based pricing (1,000 free tokens for new users)"},{"content":{"body":"## Original Request\r\n\r\n> When they create a site, that should create a new resource group starting with rg-{today date}-{sitename} e.g. 'rg-20260206-sitename' and do all the deploy work and return the temp url to the user site list page.\r\n\r\n## Problem Statement\r\n\r\nWhen a user's project build completes, the platform currently generates code files to a local `/projects/{projectId}/` directory but does not provision cloud infrastructure or deploy the project. The platform needs to automatically create an **Azure Resource Group** with a standardized naming convention (`rg-{YYYYMMDD}-{sitename}`), deploy the generated project to **Azure Container Apps** (or App Service), and return a temporary preview URL that appears on the user's site list page.\r\n\r\n**Current State:**\r\n- `ProductionService` generates project files to disk (`projects/{projectId}/`)\r\n- Generated output includes deployment config (Azure, Vercel, Docker) but nothing is executed\r\n- No Azure resource provisioning logic exists\r\n- No site list page exists for users to view their deployed projects\r\n- Status goes to `Staging` â†’ `Completed` without actual deployment\r\n\r\n## Success Criteria\r\n\r\n- [ ] When build completes, an Azure Resource Group is created with naming pattern `rg-{YYYYMMDD}-{sitename}` (e.g., `rg-20260206-my-portfolio`)\r\n- [ ] All required Azure resources are provisioned inside the resource group (Container App, Container Registry, etc.)\r\n- [ ] The generated project is containerized (Docker) and deployed to Azure Container Apps\r\n- [ ] A temporary preview URL is generated and returned (e.g., `https://my-portfolio-abc123.azurecontainerapps.io`)\r\n- [ ] The preview URL and resource group info are stored on the `DevRequest` entity\r\n- [ ] A **Site List page** shows all user's deployed projects with their URLs and status\r\n- [ ] Users can visit their deployed site immediately via the temp URL\r\n- [ ] Deployment errors are captured and shown to the user with actionable messages\r\n- [ ] Resource group and resources can be cleaned up when project is deleted or expires\r\n\r\n## Visual Mockups\r\n\r\n### Site List Page\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  AI Dev Request          [Dashboard]  [My Sites]  [Settings]    â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  My Sites (3)                                                   â”‚\r\nâ”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\r\nâ”‚  â”‚  ğŸŸ¢ my-portfolio                                          â”‚  â”‚\r\nâ”‚  â”‚  Created: 2026-02-06  â€¢  Resource Group: rg-20260206-...  â”‚  â”‚\r\nâ”‚  â”‚  URL: https://my-portfolio-abc123.azurecontainerapps.io   â”‚  â”‚\r\nâ”‚  â”‚  Status: Running  â€¢  Type: React + Vite                   â”‚  â”‚\r\nâ”‚  â”‚                                                           â”‚  â”‚\r\nâ”‚  â”‚  [ğŸ”— Open Site]  [ğŸ“‹ Details]  [ğŸ—‘ï¸ Delete]                â”‚  â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\r\nâ”‚  â”‚  ğŸŸ¡ invoice-dashboard                                     â”‚  â”‚\r\nâ”‚  â”‚  Created: 2026-02-04  â€¢  Resource Group: rg-20260204-...  â”‚  â”‚\r\nâ”‚  â”‚  URL: https://invoice-dashboard-def456.azurecontainer...  â”‚  â”‚\r\nâ”‚  â”‚  Status: Deploying...  â€¢  Type: .NET 9 API + React        â”‚  â”‚\r\nâ”‚  â”‚                                                           â”‚  â”‚\r\nâ”‚  â”‚  [â³ Deploying...]  [ğŸ“‹ Details]                           â”‚  â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\r\nâ”‚  â”‚  ğŸ”´ chatbot-landing                                       â”‚  â”‚\r\nâ”‚  â”‚  Created: 2026-01-30  â€¢  Resource Group: rg-20260130-...  â”‚  â”‚\r\nâ”‚  â”‚  URL: â€”                                                   â”‚  â”‚\r\nâ”‚  â”‚  Status: Deploy Failed  â€¢  Type: Next.js                  â”‚  â”‚\r\nâ”‚  â”‚                                                           â”‚  â”‚\r\nâ”‚  â”‚  [ğŸ”„ Retry Deploy]  [ğŸ“‹ Details]  [ğŸ—‘ï¸ Delete]             â”‚  â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Site Details Panel\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Site Details: my-portfolio                                     â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  General                                                        â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  Name:            my-portfolio                                  â”‚\r\nâ”‚  Status:          ğŸŸ¢ Running                                    â”‚\r\nâ”‚  Created:         2026-02-06 14:32 UTC                          â”‚\r\nâ”‚  Project Type:    React + Vite                                  â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Azure Resources                                                â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  Resource Group:  rg-20260206-my-portfolio                      â”‚\r\nâ”‚  Container App:   ca-my-portfolio                               â”‚\r\nâ”‚  Registry:        craidevrequest.azurecr.io                     â”‚\r\nâ”‚  Region:          Korea Central                                 â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  URLs                                                           â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  Preview URL:     https://my-portfolio-abc123.                  â”‚\r\nâ”‚                   azurecontainerapps.io                          â”‚\r\nâ”‚  Custom Domain:   (not configured)  [+ Add Domain]              â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Deployment Log                                                 â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  14:32:01  Creating resource group rg-20260206-my-portfolio     â”‚\r\nâ”‚  14:32:05  Building Docker image...                             â”‚\r\nâ”‚  14:32:45  Pushing to container registry...                     â”‚\r\nâ”‚  14:33:12  Creating Container App...                            â”‚\r\nâ”‚  14:33:38  âœ… Deployment complete                                â”‚\r\nâ”‚  14:33:39  URL: https://my-portfolio-abc123.azure...            â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚           [ğŸ”— Open Site]  [ğŸ—‘ï¸ Delete Site]  [Close]              â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Deployment Progress (During Build)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  ğŸš€ Deploying your project...                                   â”‚\r\nâ”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  âœ… Code generation complete                                     â”‚\r\nâ”‚  âœ… Resource group created: rg-20260206-my-portfolio             â”‚\r\nâ”‚  âœ… Docker image built                                           â”‚\r\nâ”‚  â³ Pushing to container registry...  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 65%         â”‚\r\nâ”‚  â—‹  Creating Container App                                      â”‚\r\nâ”‚  â—‹  Health check & URL generation                               â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Estimated time remaining: ~45 seconds                          â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Backend â€” Azure Deployment Service\r\n\r\nCreate a new `IDeploymentService` / `AzureDeploymentService`:\r\n\r\n**Resource Group Creation:**\r\n```\r\nName pattern: rg-{yyyyMMdd}-{sanitized-sitename}\r\n  - sitename: lowercase, alphanumeric + hyphens, max 40 chars\r\n  - e.g., rg-20260206-my-portfolio\r\nRegion: Korea Central (default) or user-configured\r\nTags: { \"project\": projectId, \"user\": userId, \"created-by\": \"ai-dev-request\" }\r\n```\r\n\r\n**Deployment Pipeline (sequential):**\r\n1. `az group create` â€” Create resource group\r\n2. Generate `Dockerfile` from project type (React â†’ nginx, .NET â†’ dotnet/aspnet, etc.)\r\n3. `az acr build` â€” Build & push Docker image to shared Azure Container Registry\r\n4. `az containerapp create` â€” Create Container App in the resource group\r\n5. Retrieve the auto-generated FQDN as the temp preview URL\r\n6. Store URL and resource group name on `DevRequest` entity\r\n\r\n**Use Azure SDK for .NET** (`Azure.ResourceManager`, `Azure.ResourceManager.AppContainers`) for programmatic resource management rather than CLI commands.\r\n\r\n### Backend â€” Entity Changes\r\n\r\nAdd fields to `DevRequest` (or create a new `Deployment` entity):\r\n```\r\nResourceGroupName:  string  (e.g., \"rg-20260206-my-portfolio\")\r\nDeploymentStatus:   enum    (Pending, Provisioning, Building, Deploying, Running, Failed, Deleted)\r\nPreviewUrl:         string  (e.g., \"https://my-portfolio-abc123.azurecontainerapps.io\")\r\nDeploymentLog:      string  (JSONB â€” array of timestamped log entries)\r\nDeployedAt:         DateTime?\r\n```\r\n\r\n### Backend â€” New Endpoints\r\n- `GET /api/sites` â€” List all user's deployed sites\r\n- `GET /api/sites/{id}` â€” Site detail with deployment info\r\n- `DELETE /api/sites/{id}` â€” Delete site and clean up Azure resources\r\n- `POST /api/sites/{id}/redeploy` â€” Retry failed deployment\r\n\r\n### Frontend â€” Site List Page\r\n- Add \"My Sites\" navigation item\r\n- Create site list page showing all deployed projects\r\n- Each card shows: name, status indicator, preview URL (clickable), creation date, project type\r\n- Actions: Open Site, View Details, Delete, Retry (on failure)\r\n- Real-time deployment progress during build phase (poll or SSE)\r\n\r\n### Resource Naming Convention\r\n```\r\nResource Group:    rg-{YYYYMMDD}-{sitename}\r\nContainer App:     ca-{sitename}\r\nContainer Image:   craidevrequest.azurecr.io/{sitename}:latest\r\n```\r\n\r\n### Cleanup Strategy\r\n- When user deletes a site â†’ `az group delete` removes all resources in the group\r\n- Optional: auto-expire free-tier sites after 7 days (per existing plan)\r\n- Resource groups tagged for easy identification and bulk cleanup\r\n\r\n## Out of Scope\r\n\r\n- Custom domain configuration (future enhancement)\r\n- SSL certificate management beyond Azure-provided defaults\r\n- Multi-region deployment\r\n- CI/CD pipeline for user code changes after initial deploy\r\n- Database provisioning within the resource group (static sites only for MVP)\r\n- Scaling configuration (use Azure Container Apps defaults)\r\n- Cost monitoring per resource group\r\n\r\n## Dependencies\r\n\r\n- Azure subscription with appropriate permissions (Contributor role on subscription)\r\n- Azure Container Registry (shared, pre-provisioned: `craidevrequest.azurecr.io`)\r\n- User authentication system (need userId to scope site list)\r\n- **#13** â€” Token system (build stage token deduction triggers deployment)\r\n- Service principal or managed identity for Azure SDK authentication\r\n","number":15,"repository":"bradyoo12/ai-dev-request","title":"feat: auto-create Azure resource group and deploy site with temp URL","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/15"},"id":"PVTI_lAHNf9fOATn4hM4JPhzy","repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: auto-create Azure resource group and deploy site with temp URL"},{"content":{"body":"## Original Request\r\n\r\n> Token user has will be spent while they design, plan and implement their site.\r\n\r\n## Problem Statement\r\n\r\nThe platform's AI-powered workflow has three distinct billable stages â€” **Analysis (Design)**, **Proposal (Plan)**, and **Build (Implement)** â€” each making Claude API calls of varying cost. Currently, these stages run without any token consumption tracking or balance enforcement. With the token-based pricing system (#13), each stage needs to deduct tokens from the user's balance proportional to the AI resources consumed.\r\n\r\n**Current Workflow Stages & Estimated AI Cost:**\r\n\r\n| Stage | What Happens | Claude MaxTokens | Est. API Tokens Used |\r\n|-------|-------------|-----------------|---------------------|\r\n| **Design (Analysis)** | AI classifies request, assesses complexity, suggests tech stack | 2,000 | ~1,600â€“2,300 |\r\n| **Plan (Proposal)** | AI generates architecture, milestones, pricing, scope | 4,000 | ~4,500â€“6,000 |\r\n| **Implement (Build)** | AI generates project scaffolding, core files, configs | 8,000 | ~9,000â€“12,000 |\r\n\r\n**Current Problem:**\r\n- `AnalysisService`, `ProposalService`, and `ProductionService` all call Claude API but never read `response.Usage` (input/output token counts are discarded)\r\n- No balance check before executing any stage\r\n- No token deduction after completion\r\n- Users can run unlimited AI calls with no cost control\r\n\r\n## Success Criteria\r\n\r\n- [ ] Each workflow stage (Design, Plan, Implement) deducts tokens from the user's balance\r\n- [ ] Token cost is checked **before** each stage begins â€” insufficient balance blocks execution\r\n- [ ] Actual Claude API token usage (`response.Usage.InputTokens`, `OutputTokens`) is captured after each call\r\n- [ ] Token deduction is based on predefined costs per stage (not raw API token count) for predictable pricing\r\n- [ ] A `TokenTransaction` record is created for each stage with action type, amount, and reference to the `DevRequest`\r\n- [ ] Users see a confirmation dialog showing token cost before triggering each stage\r\n- [ ] Frontend displays remaining balance after each stage completes\r\n- [ ] If a stage fails (API error, timeout), tokens are NOT deducted\r\n- [ ] Token costs per stage are configurable by admin via `TokenPricing` table\r\n\r\n## Visual Mockups\r\n\r\n### User Flow â€” Token Gating Per Stage\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚                                                                 â”‚\r\nâ”‚   User Journey with Token Costs                                 â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚\r\nâ”‚   â”‚  DESIGN  â”‚â”€â”€â”€â”€â–¶â”‚   PLAN   â”‚â”€â”€â”€â”€â–¶â”‚  BUILD   â”‚               â”‚\r\nâ”‚   â”‚ (Analyze)â”‚     â”‚(Proposal)â”‚     â”‚(Generate)â”‚               â”‚\r\nâ”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜               â”‚\r\nâ”‚        â”‚                â”‚                â”‚                      â”‚\r\nâ”‚    ğŸª™ 50 tokens     ğŸª™ 100 tokens    ğŸª™ 300 tokens              â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚   Total for full cycle: ğŸª™ 450 tokens ($4.50)                   â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚   Starting balance:  1,000 tokens                               â”‚\r\nâ”‚   After full cycle:    550 tokens remaining                     â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Pre-Stage Confirmation Dialog (Design)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Start AI Design Analysis             â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                       â”‚\r\nâ”‚  This will analyze your request       â”‚\r\nâ”‚  using AI to determine:               â”‚\r\nâ”‚  â€¢ Project category & complexity      â”‚\r\nâ”‚  â€¢ Tech stack recommendation          â”‚\r\nâ”‚  â€¢ Feasibility assessment             â”‚\r\nâ”‚                                       â”‚\r\nâ”‚  Cost:  ğŸª™ 50 tokens ($0.50)          â”‚\r\nâ”‚  Balance: ğŸª™ 1,000 â†’ 950 tokens      â”‚\r\nâ”‚                                       â”‚\r\nâ”‚         [Cancel]  [â–¶ Start Design]    â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Pre-Stage Confirmation Dialog (Plan)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Generate Project Proposal            â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                       â”‚\r\nâ”‚  This will generate a detailed plan:  â”‚\r\nâ”‚  â€¢ Architecture & components          â”‚\r\nâ”‚  â€¢ Phased milestones                  â”‚\r\nâ”‚  â€¢ Development cost estimate          â”‚\r\nâ”‚  â€¢ Timeline & deliverables            â”‚\r\nâ”‚                                       â”‚\r\nâ”‚  Cost:  ğŸª™ 100 tokens ($1.00)         â”‚\r\nâ”‚  Balance: ğŸª™ 950 â†’ 850 tokens        â”‚\r\nâ”‚                                       â”‚\r\nâ”‚         [Cancel]  [â–¶ Generate Plan]   â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Pre-Stage Confirmation Dialog (Build)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Build Your Project                   â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                       â”‚\r\nâ”‚  This will generate your project:     â”‚\r\nâ”‚  â€¢ Project scaffolding & config       â”‚\r\nâ”‚  â€¢ Core source code files             â”‚\r\nâ”‚  â€¢ Build & deployment setup           â”‚\r\nâ”‚                                       â”‚\r\nâ”‚  Cost:  ğŸª™ 300 tokens ($3.00)         â”‚\r\nâ”‚  Balance: ğŸª™ 850 â†’ 550 tokens        â”‚\r\nâ”‚                                       â”‚\r\nâ”‚         [Cancel]  [â–¶ Start Build]     â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Insufficient Balance Block\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  âš ï¸ Insufficient Tokens               â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                       â”‚\r\nâ”‚  \"Generate Project Proposal\"          â”‚\r\nâ”‚  requires ğŸª™ 100 tokens               â”‚\r\nâ”‚                                       â”‚\r\nâ”‚  Your balance: ğŸª™ 43 tokens           â”‚\r\nâ”‚  You need 57 more tokens.             â”‚\r\nâ”‚                                       â”‚\r\nâ”‚       [Cancel]  [ğŸª™ Buy Tokens]       â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Post-Stage Balance Update (Inline)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  âœ… Analysis Complete                                        â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚  Category: Web Application                                  â”‚\r\nâ”‚  Complexity: Medium                                         â”‚\r\nâ”‚  Feasibility: 92%                                           â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚  ğŸª™ 50 tokens used  â€¢  Balance: 950 tokens remaining        â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚  [â–¶ Generate Proposal (ğŸª™ 100)]                              â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Backend â€” Token Gating Middleware\r\n\r\nAdd a reusable token deduction pattern to the three AI services:\r\n\r\n```\r\n1. Check user's TokenBalance >= required cost for this action\r\n2. If insufficient â†’ return 402 Payment Required with { required, balance, action }\r\n3. Execute AI service call (AnalysisService / ProposalService / ProductionService)\r\n4. Capture response.Usage.InputTokens and OutputTokens (for analytics)\r\n5. If AI call succeeds â†’ atomically debit tokens and create TokenTransaction\r\n6. If AI call fails â†’ do NOT debit, return error\r\n```\r\n\r\n**Suggested approach:** Create an `ITokenService` with methods:\r\n- `CheckBalance(userId, requiredTokens)` â†’ bool\r\n- `DebitTokens(userId, amount, actionType, referenceId)` â†’ TokenTransaction\r\n- `GetCostForAction(actionType)` â†’ int (reads from TokenPricing table)\r\n\r\nWire this into `RequestsController` before each stage endpoint:\r\n- `POST /api/requests/{id}/analyze` â†’ check & debit Design cost\r\n- `POST /api/requests/{id}/proposal` â†’ check & debit Plan cost\r\n- `POST /api/requests/{id}/build` â†’ check & debit Build cost\r\n\r\n### Backend â€” Capture Actual API Usage\r\n\r\nIn each service (`AnalysisService`, `ProposalService`, `ProductionService`), after the Claude API call:\r\n```csharp\r\nvar response = await _client.Messages.GetClaudeMessageAsync(parameters);\r\n// NEW: capture actual usage for analytics\r\nvar actualInputTokens = response.Usage?.InputTokens ?? 0;\r\nvar actualOutputTokens = response.Usage?.OutputTokens ?? 0;\r\n// Store in TokenTransaction or a separate UsageLog table\r\n```\r\n\r\n### Frontend â€” Confirmation Before Each Stage\r\n\r\n- Before calling analyze/proposal/build endpoints, show a confirmation dialog with token cost\r\n- Fetch token cost from `GET /api/pricing/token-costs` (or embed in existing response)\r\n- On 402 response, show \"Insufficient Tokens\" dialog with link to buy tokens\r\n- After each stage completes, display inline balance update\r\n\r\n### Token Pricing Configuration (Default Values)\r\n\r\n| Action | Token Cost | USD Value | Rationale |\r\n|--------|-----------|-----------|-----------|\r\n| Design (Analysis) | 50 | $0.50 | Lightweight AI call, ~2K tokens |\r\n| Plan (Proposal) | 100 | $1.00 | Medium AI call, ~5K tokens |\r\n| Build (Implement) | 300 | $3.00 | Heavy AI call, ~10K tokens + file generation |\r\n\r\nThese values should be stored in `TokenPricing` table and configurable by admin.\r\n\r\n## Out of Scope\r\n\r\n- Dynamic token pricing based on actual Claude API usage (use fixed per-stage costs for predictability)\r\n- Re-running a stage at reduced cost (re-analysis, re-proposal always costs full price)\r\n- Partial refunds if user is unsatisfied with AI output\r\n- Token cost for viewing/downloading previously generated results (read-only is free)\r\n- Streaming cost estimation (charge flat rate regardless of response length)\r\n\r\n## Dependencies\r\n\r\n- **#13** â€” Token balance and settings page (provides `TokenBalance`, `TokenTransaction`, `TokenPricing` entities)\r\n- User authentication system (need `userId` to track balances)\r\n","number":14,"repository":"bradyoo12/ai-dev-request","title":"feat: deduct tokens during design, plan, and build stages","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/14"},"id":"PVTI_lAHNf9fOATn4hM4JPhzY","linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/24"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: deduct tokens during design, plan, and build stages"},{"content":{"body":"## Original Request\r\n\r\n> Let user buy token using Stripe. Add a setting page for Stripe and user payment as well.\r\n\r\n## Problem Statement\r\n\r\nThe platform's token system (#13) defines token packages users can purchase (500 tokens/$5, 1,000/$10, 3,000/$25, 10,000/$70), but there is **no payment processing** â€” the \"Buy Tokens\" flow has no way to actually charge users. Additionally, domain purchases (#16) also need a payment method.\r\n\r\nThe platform needs **Stripe integration** for:\r\n1. **Token purchases** â€” users buy token packages via Stripe Checkout or embedded payment form\r\n2. **Admin Stripe settings** â€” admin configures Stripe API keys, webhook secrets, and pricing\r\n3. **User payment settings** â€” users manage saved payment methods, view payment history, and download receipts\r\n\r\n**Current State:**\r\n- No payment gateway of any kind exists\r\n- No Stripe SDK or configuration\r\n- Token packages are defined (#13) but have no purchase flow\r\n- Domain pricing (#16) mentions card payment but has no implementation\r\n- No payment history, receipts, or invoicing\r\n- No admin settings for payment configuration\r\n\r\n## Success Criteria\r\n\r\n- [ ] Users can purchase token packages using Stripe (credit/debit card, Apple Pay, Google Pay)\r\n- [ ] Stripe Checkout or Stripe Elements is integrated on the frontend\r\n- [ ] Successful payment automatically credits tokens to the user's balance\r\n- [ ] Failed/cancelled payments do not credit tokens\r\n- [ ] Stripe webhooks handle async payment confirmation (payment_intent.succeeded, etc.)\r\n- [ ] Users can save payment methods for faster future purchases\r\n- [ ] User payment settings page shows: saved cards, payment history, and receipts\r\n- [ ] Admin settings page allows configuring Stripe API keys and webhook secret\r\n- [ ] Admin can manage token packages (price, token amount, active/inactive)\r\n- [ ] Payment receipts are emailed via Stripe (or downloadable from payment history)\r\n- [ ] All monetary transactions are logged with Stripe payment intent IDs\r\n\r\n## Visual Mockups\r\n\r\n### Token Purchase â€” Stripe Checkout Flow\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Settings > Token Balance                                       â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Current Balance: ğŸª™ 143 tokens                                 â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Buy Tokens                                                     â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚\r\nâ”‚   â”‚   500 tokens  â”‚  â”‚ 1,000 tokens â”‚  â”‚ 3,000 tokens â”‚         â”‚\r\nâ”‚   â”‚    $5.00      â”‚  â”‚   $10.00     â”‚  â”‚   $25.00     â”‚         â”‚\r\nâ”‚   â”‚               â”‚  â”‚    â­        â”‚  â”‚  save 17%    â”‚         â”‚\r\nâ”‚   â”‚   [Select]    â”‚  â”‚  [Select]    â”‚  â”‚  [Select]    â”‚         â”‚\r\nâ”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚\r\nâ”‚   â”‚ 10,000 tokensâ”‚     ğŸ’³ Saved card: **** 4242                 â”‚\r\nâ”‚   â”‚   $70.00     â”‚     [Use saved card]  or  [New card]         â”‚\r\nâ”‚   â”‚  save 30%    â”‚                                              â”‚\r\nâ”‚   â”‚   [Select]   â”‚                                              â”‚\r\nâ”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Stripe Embedded Payment Form (After Select)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Complete Purchase                  â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                     â”‚\r\nâ”‚  1,000 tokens â€” $10.00              â”‚\r\nâ”‚                                     â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\r\nâ”‚  â”‚  Card number                â”‚    â”‚\r\nâ”‚  â”‚  4242 4242 4242 4242        â”‚    â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚\r\nâ”‚  â”‚  MM / YY     â”‚  CVC         â”‚    â”‚\r\nâ”‚  â”‚  12 / 28     â”‚  123         â”‚    â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\r\nâ”‚                                     â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\r\nâ”‚  â”‚  Cardholder name            â”‚    â”‚\r\nâ”‚  â”‚  Brady Yoo                  â”‚    â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\r\nâ”‚                                     â”‚\r\nâ”‚  â˜ Save this card for future use    â”‚\r\nâ”‚                                     â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”              â”‚\r\nâ”‚  â”‚ GPay  â”‚  â”‚ APay  â”‚  or pay by   â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  card above  â”‚\r\nâ”‚                                     â”‚\r\nâ”‚           [Cancel]  [Pay $10.00]    â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### User Settings â€” Payment Methods\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Settings > Payment Methods                                     â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  Saved Payment Methods                     [+ Add Card]         â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\r\nâ”‚  â”‚  ğŸ’³ Visa ending in 4242                                    â”‚  â”‚\r\nâ”‚  â”‚  Expires 12/2028  â€¢  Default                               â”‚  â”‚\r\nâ”‚  â”‚                          [Set Default]  [Remove]           â”‚  â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\r\nâ”‚  â”‚  ğŸ’³ Mastercard ending in 8888                              â”‚  â”‚\r\nâ”‚  â”‚  Expires 06/2027                                           â”‚  â”‚\r\nâ”‚  â”‚                          [Set Default]  [Remove]           â”‚  â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### User Settings â€” Payment History\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Settings > Payment History                                     â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  Filter: [All â–¾]  [Last 3 months â–¾]                             â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  â”‚ Date       â”‚ Description         â”‚ Amount â”‚ Status â”‚ Rcpt  â”‚ â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚\r\nâ”‚  â”‚ 2026-02-06 â”‚ 1,000 tokens        â”‚ $10.00 â”‚ âœ… Paid â”‚ [ğŸ“„] â”‚ â”‚\r\nâ”‚  â”‚ 2026-02-03 â”‚ 500 tokens          â”‚  $5.00 â”‚ âœ… Paid â”‚ [ğŸ“„] â”‚ â”‚\r\nâ”‚  â”‚ 2026-01-28 â”‚ Domain: my-site.dev â”‚ $14.99 â”‚ âœ… Paid â”‚ [ğŸ“„] â”‚ â”‚\r\nâ”‚  â”‚ 2026-01-15 â”‚ 3,000 tokens        â”‚ $25.00 â”‚ âœ… Paid â”‚ [ğŸ“„] â”‚ â”‚\r\nâ”‚  â”‚ 2026-01-10 â”‚ 500 tokens          â”‚  $5.00 â”‚ âŒ Fail â”‚  â€”   â”‚ â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Total spent: $54.99                     [Load More...]         â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Admin Settings â€” Stripe Configuration\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Admin > Settings > Stripe Configuration                        â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  API Keys                                                       â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  Mode:  â—‹ Test  â— Live                                          â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Publishable Key:                                               â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚\r\nâ”‚  â”‚ pk_live_************************************xyz â”‚            â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚\r\nâ”‚  Secret Key:                                                    â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚\r\nâ”‚  â”‚ sk_live_â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â”‚            â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚\r\nâ”‚  Webhook Secret:                                                â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚\r\nâ”‚  â”‚ whsec_â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢  â”‚            â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚\r\nâ”‚  Webhook URL: https://api.ai-dev-request.kr/api/webhooks/stripe â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  [Test Connection]  [Save]                                      â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Token Packages                                                 â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  â”‚ Name    â”‚ Tokens â”‚ Price  â”‚ Discount â”‚ Stripe Price ID â”‚ Actâ”‚â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤â”‚\r\nâ”‚  â”‚ Basic   â”‚    500 â”‚  $5.00 â”‚ â€”        â”‚ price_abc123    â”‚ âœ… â”‚â”‚\r\nâ”‚  â”‚ Popular â”‚  1,000 â”‚ $10.00 â”‚ â€”        â”‚ price_def456    â”‚ âœ… â”‚â”‚\r\nâ”‚  â”‚ Value   â”‚  3,000 â”‚ $25.00 â”‚ 17%      â”‚ price_ghi789    â”‚ âœ… â”‚â”‚\r\nâ”‚  â”‚ Bulk    â”‚ 10,000 â”‚ $70.00 â”‚ 30%      â”‚ price_jkl012    â”‚ âœ… â”‚â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  [+ Add Package]                                                â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Settings Navigation (Updated)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Settings              â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚\r\nâ”‚  ğŸª™ Token Balance      â”‚\r\nâ”‚  ğŸ’³ Payment Methods    â”‚\r\nâ”‚  ğŸ“œ Payment History    â”‚\r\nâ”‚  ğŸŒ Language           â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ (admin only)\r\nâ”‚  âš™ï¸ Stripe Config     â”‚\r\nâ”‚  ğŸ“¦ Token Packages    â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Backend â€” Stripe Integration\r\n\r\n**NuGet Package:** `Stripe.net`\r\n\r\n**New Service â€” `IPaymentService` / `StripePaymentService`:**\r\n- `CreateCheckoutSession(userId, packageId)` â€” Creates Stripe Checkout Session for token purchase\r\n- `HandleWebhook(payload, signature)` â€” Processes Stripe webhook events\r\n- `GetPaymentHistory(userId)` â€” Retrieves user's payment records\r\n- `SavePaymentMethod(userId, stripePaymentMethodId)` â€” Saves card for future use\r\n- `RemovePaymentMethod(userId, paymentMethodId)` â€” Removes saved card\r\n- `CreatePaymentIntent(userId, amount, description)` â€” For embedded payments (domains, etc.)\r\n\r\n**Stripe Webhook Handler:**\r\nListen for these events at `POST /api/webhooks/stripe`:\r\n- `checkout.session.completed` â€” Credit tokens to user balance\r\n- `payment_intent.succeeded` â€” Confirm payment, log transaction\r\n- `payment_intent.payment_failed` â€” Log failure, notify user\r\n- `customer.subscription.deleted` â€” Handle cancellations (future)\r\n\r\n**Critical: Webhook-first architecture** â€” Only credit tokens after receiving webhook confirmation from Stripe, never on client-side callback alone (prevents fraud).\r\n\r\n### Backend â€” New Entities\r\n\r\n```\r\nPayment:\r\n  id, user_id, stripe_payment_intent_id, stripe_checkout_session_id,\r\n  type (token_purchase / domain_purchase / subscription),\r\n  amount_usd, currency, status (pending/succeeded/failed/refunded),\r\n  description, token_package_id (nullable), metadata_json,\r\n  created_at, updated_at\r\n\r\nPaymentMethod:\r\n  id, user_id, stripe_payment_method_id, stripe_customer_id,\r\n  card_brand, card_last4, card_exp_month, card_exp_year,\r\n  is_default, created_at\r\n\r\nStripeConfig (admin settings â€” store encrypted):\r\n  id, mode (test/live), publishable_key, secret_key (encrypted),\r\n  webhook_secret (encrypted), is_active, updated_at\r\n```\r\n\r\n### Backend â€” New Endpoints\r\n\r\n**User Endpoints:**\r\n- `POST /api/payments/checkout` â€” Create Stripe Checkout Session for token package\r\n- `POST /api/payments/create-intent` â€” Create payment intent for embedded form\r\n- `GET /api/payments/history` â€” Paginated payment history\r\n- `GET /api/payments/methods` â€” List saved payment methods\r\n- `POST /api/payments/methods` â€” Save payment method\r\n- `DELETE /api/payments/methods/{id}` â€” Remove payment method\r\n- `PUT /api/payments/methods/{id}/default` â€” Set default payment method\r\n- `GET /api/payments/{id}/receipt` â€” Download receipt (redirect to Stripe receipt URL)\r\n\r\n**Webhook Endpoint:**\r\n- `POST /api/webhooks/stripe` â€” Stripe webhook handler (no auth, verified by signature)\r\n\r\n**Admin Endpoints:**\r\n- `GET /api/admin/stripe/config` â€” Get Stripe config (keys masked)\r\n- `PUT /api/admin/stripe/config` â€” Update Stripe configuration\r\n- `POST /api/admin/stripe/test` â€” Test Stripe connection\r\n- `GET /api/admin/token-packages` â€” List token packages with Stripe price IDs\r\n- `POST /api/admin/token-packages` â€” Create token package (also creates Stripe Price)\r\n- `PUT /api/admin/token-packages/{id}` â€” Update package\r\n- `DELETE /api/admin/token-packages/{id}` â€” Deactivate package\r\n\r\n### Frontend\r\n\r\n**Stripe Integration Options (choose one):**\r\n1. **Stripe Checkout (Recommended for MVP):** Redirect to Stripe-hosted page â€” minimal frontend code, PCI compliant out-of-box\r\n2. **Stripe Elements (Better UX):** Embedded payment form using `@stripe/react-stripe-js` â€” stays on-site, more control over UI\r\n\r\n**User Settings Pages:**\r\n- Payment Methods tab â€” list saved cards, add/remove, set default\r\n- Payment History tab â€” table with date, description, amount, status, receipt download link\r\n- Token Balance tab (#13) â€” add \"Buy with saved card\" quick action\r\n\r\n**Admin Settings Page:**\r\n- Stripe configuration form (keys, webhook URL, test/live toggle)\r\n- Token package management CRUD\r\n- Connection test button\r\n\r\n### Security Considerations\r\n\r\n- **Never expose Stripe Secret Key** to frontend (publishable key only)\r\n- Store secret key and webhook secret **encrypted** in database (use ASP.NET Data Protection or Azure Key Vault)\r\n- Verify Stripe webhook signatures using `stripe-signature` header\r\n- Use Stripe Customer objects to link saved payment methods to users\r\n- All payment endpoints require `[Authorize]`\r\n- Webhook endpoint verifies Stripe signature instead of JWT auth\r\n- Log all payment events for audit trail\r\n\r\n### Stripe Customer Lifecycle\r\n\r\n```\r\nUser signs up\r\n  â†’ Create Stripe Customer (store stripe_customer_id on User entity)\r\n  â†’ On first purchase: attach PaymentMethod to Customer\r\n  â†’ Future purchases: use saved PaymentMethod or add new one\r\n  â†’ Stripe handles receipts, disputes, refunds via dashboard\r\n```\r\n\r\n## Out of Scope\r\n\r\n- Subscription/recurring billing (monthly plans â€” future ticket)\r\n- Stripe Connect (marketplace payments to third parties)\r\n- Cryptocurrency payments\r\n- PayPal, bank transfer, or non-Stripe payment methods\r\n- Invoice generation beyond Stripe's built-in receipts\r\n- Tax calculation (Stripe Tax â€” future enhancement)\r\n- Multi-currency support (USD only for MVP)\r\n- Refund flow from within the app (use Stripe Dashboard for now)\r\n- Promo codes / coupon system (Stripe Coupons â€” future enhancement)\r\n\r\n## Dependencies\r\n\r\n- **#13** â€” Token system (token balance, packages, and transaction entities)\r\n- **#18** â€” User authentication (need user accounts for Stripe Customer mapping)\r\n- **#16** â€” Domain purchases (will reuse Stripe payment flow for domain payments)\r\n- Stripe account setup (obtain API keys, configure webhook endpoint)\r\n- SSL required for Stripe integration (already handled by Azure)\r\n","number":19,"repository":"bradyoo12/ai-dev-request","title":"feat: Stripe payment integration for token purchases with admin and user settings","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/19"},"id":"PVTI_lAHNf9fOATn4hM4JPjN8","linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/31"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: Stripe payment integration for token purchases with admin and user settings"},{"content":{"body":"## Original Request\r\n\r\n> User should be able to log in using their Google, Apple, LINE, Kakao account and so on. Site should know where the user is and show the login buttons in order of popularity in that country.\r\n\r\n## Problem Statement\r\n\r\nThe AI Dev Request platform currently has **no authentication system** â€” all API endpoints are publicly accessible and there is no concept of a user account. Users need to log in via social providers to access features like token balance (#13), site management (#15), and domain purchases (#16).\r\n\r\nAdditionally, the platform targets a global audience, so login buttons should be **geo-ordered** â€” showing the most popular social login providers for the user's detected country first (e.g., Kakao first in Korea, LINE first in Japan, Google first in US/Europe).\r\n\r\n**Current State:**\r\n- Zero authentication in ai-dev-request (no auth middleware, no user entity, no login UI)\r\n- BradYoo.Core has **production-ready Google and Kakao OAuth** (`AuthService.cs`) with JWT generation\r\n- Other BradYoo services (tax-ai, SiteAgent) already use BradYoo.Core Auth as a reference pattern\r\n- No geolocation or IP-based country detection exists anywhere in the ecosystem\r\n- Frontend has no login page, no auth state management, no protected routes\r\n\r\n**BradYoo.Core Auth Already Supports:**\r\n- Google OAuth (ID token validation via `GoogleJsonWebSignature`)\r\n- Kakao OAuth (token validation via Kakao API)\r\n- JWT generation (HMAC-SHA256, 7-day expiry, user claims)\r\n\r\n**Needs to be Added:**\r\n- Apple Sign-In\r\n- LINE Login\r\n- Geo-detection for provider ordering\r\n\r\n## Success Criteria\r\n\r\n- [ ] Users can log in via **Google**, **Apple**, **LINE**, and **Kakao** social accounts\r\n- [ ] Login page detects user's country (via IP geolocation) and orders login buttons by popularity\r\n- [ ] JWT token is issued on successful login and used for authenticated API requests\r\n- [ ] User entity is created on first login and persisted in the database\r\n- [ ] Auth middleware protects endpoints that require authentication\r\n- [ ] Login state persists across page refreshes (token stored in httpOnly cookie or localStorage)\r\n- [ ] Logout functionality clears session and tokens\r\n- [ ] Login page is responsive and shows provider logos/branding correctly\r\n- [ ] Fallback ordering works when geolocation fails (default: Google first)\r\n- [ ] Existing BradYoo.Core auth infrastructure is reused and extended (not duplicated)\r\n\r\n## Provider Priority by Country\r\n\r\n| Country | Order (most popular first) |\r\n|---------|---------------------------|\r\n| South Korea | Kakao, Google, Apple, LINE |\r\n| Japan | LINE, Google, Apple, Kakao |\r\n| United States | Google, Apple, LINE, Kakao |\r\n| Europe (default) | Google, Apple, Kakao, LINE |\r\n| Southeast Asia | Google, LINE, Apple, Kakao |\r\n| Global fallback | Google, Apple, Kakao, LINE |\r\n\r\n## Visual Mockups\r\n\r\n### Login Page â€” Korean User (detected via IP)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚                                                             â”‚\r\nâ”‚              ğŸ—ï¸  AI Dev Request                              â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚           ì•„ì´ë””ì–´ë¥¼ í˜„ì‹¤ë¡œ ë§Œë“¤ì–´ë³´ì„¸ìš”                       â”‚\r\nâ”‚         Sign in to start building your project              â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  ğŸ’¬  ì¹´ì¹´ì˜¤ë¡œ ì‹œì‘í•˜ê¸°                â”‚  â† #1 Korea â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  G   Continue with Google            â”‚  â† #2      â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  ğŸ  Continue with Apple             â”‚  â† #3      â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  ğŸ’š  LINEã§ãƒ­ã‚°ã‚¤ãƒ³                   â”‚  â† #4      â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚         By continuing, you agree to our                     â”‚\r\nâ”‚         Terms of Service and Privacy Policy                 â”‚\r\nâ”‚                                                             â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Login Page â€” Japanese User\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚                                                             â”‚\r\nâ”‚              ğŸ—ï¸  AI Dev Request                              â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚           ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å½¢ã«ã—ã¾ã—ã‚‡ã†                             â”‚\r\nâ”‚         Sign in to start building your project              â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  ğŸ’š  LINEã§ãƒ­ã‚°ã‚¤ãƒ³                   â”‚  â† #1 Japanâ”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  G   Continue with Google            â”‚  â† #2      â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  ğŸ  Continue with Apple             â”‚  â† #3      â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  ğŸ’¬  ì¹´ì¹´ì˜¤ë¡œ ì‹œì‘í•˜ê¸°                â”‚  â† #4      â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚                                                             â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Login Page â€” US/Global User\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚                                                             â”‚\r\nâ”‚              ğŸ—ï¸  AI Dev Request                              â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚           Turn your ideas into reality                      â”‚\r\nâ”‚         Sign in to start building your project              â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  G   Continue with Google            â”‚  â† #1 US   â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  ğŸ  Continue with Apple             â”‚  â† #2      â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  ğŸ’š  Continue with LINE              â”‚  â† #3      â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚\r\nâ”‚         â”‚  ğŸ’¬  Continue with Kakao             â”‚  â† #4      â”‚\r\nâ”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚\r\nâ”‚                                                             â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Header â€” Authenticated State\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  ğŸ—ï¸ AI Dev Request     [Dashboard] [My Sites] [Settings]    â”‚\r\nâ”‚                                                             â”‚\r\nâ”‚                               ğŸª™ 743  [Brady Y. â–¾]          â”‚\r\nâ”‚                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚\r\nâ”‚                                       â”‚ ğŸ‘¤ My Account â”‚      â”‚\r\nâ”‚                                       â”‚ âš™ï¸ Settings   â”‚      â”‚\r\nâ”‚                                       â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚      â”‚\r\nâ”‚                                       â”‚ ğŸšª Log Out   â”‚      â”‚\r\nâ”‚                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Header â€” Unauthenticated State\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  ğŸ—ï¸ AI Dev Request              [Pricing]  [Sign In]        â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Backend â€” Extend BradYoo.Core Auth\r\n\r\n**Add new OAuth providers to BradYoo.Core:**\r\n\r\n1. **Apple Sign-In:**\r\n   - Validate Apple ID token (JWT from Apple)\r\n   - Use Apple's public keys endpoint for verification\r\n   - Extract email and name from token claims\r\n   - Add `AppleSettings` to `AuthConfiguration`\r\n\r\n2. **LINE Login:**\r\n   - Validate LINE access token via `https://api.line.me/v2/profile`\r\n   - Extract userId, displayName, pictureUrl\r\n   - Add `LineSettings` to `AuthConfiguration`\r\n\r\n**Update `AuthConfiguration.cs`:**\r\n```\r\nAdd: AppleSettings (TeamId, KeyId, ClientId, PrivateKey)\r\nAdd: LineSettings (ChannelId, ChannelSecret)\r\n```\r\n\r\n### Backend â€” AI Dev Request Auth Integration\r\n\r\n1. **Add `AuthController`** (follow tax-ai pattern):\r\n   - `POST /api/auth/google` â€” Google login\r\n   - `POST /api/auth/apple` â€” Apple login\r\n   - `POST /api/auth/line` â€” LINE login\r\n   - `POST /api/auth/kakao` â€” Kakao login\r\n   - `GET /api/auth/me` â€” Get current user\r\n   - `POST /api/auth/logout` â€” Logout\r\n\r\n2. **Add JWT middleware to `Program.cs`:**\r\n   - Register `IAuthService` from BradYoo.Core\r\n   - Add `Authentication` and `Authorization` middleware\r\n   - Configure JWT bearer validation\r\n\r\n3. **Add `[Authorize]` to protected endpoints** (requests, sites, domains, settings)\r\n\r\n### Backend â€” Geolocation\r\n\r\n**Add geo-detection endpoint:**\r\n- `GET /api/auth/providers` â€” Returns ordered list of login providers\r\n- Reads client IP from `X-Forwarded-For` or `HttpContext.Connection.RemoteIpAddress`\r\n- Uses a lightweight IP-to-country database (MaxMind GeoLite2 free tier or ip-api.com)\r\n- Maps country code to provider priority list\r\n- Returns: `{ country: \"KR\", providers: [\"kakao\", \"google\", \"apple\", \"line\"] }`\r\n\r\n**Provider ordering config** â€” store in `appsettings.json` or database:\r\n```json\r\n{\r\n  \"AuthProviderOrder\": {\r\n    \"KR\": [\"kakao\", \"google\", \"apple\", \"line\"],\r\n    \"JP\": [\"line\", \"google\", \"apple\", \"kakao\"],\r\n    \"US\": [\"google\", \"apple\", \"line\", \"kakao\"],\r\n    \"default\": [\"google\", \"apple\", \"kakao\", \"line\"]\r\n  }\r\n}\r\n```\r\n\r\n### Frontend\r\n\r\n1. **Login page component** with dynamic provider button ordering\r\n2. On page load: call `GET /api/auth/providers` to get geo-ordered providers\r\n3. Render login buttons in returned order with proper branding (colors, logos, text)\r\n4. OAuth redirect flow: button click â†’ provider consent â†’ callback â†’ JWT issued â†’ redirect to app\r\n5. Store JWT in httpOnly cookie (preferred) or localStorage\r\n6. Add auth state to app (Zustand store or React context)\r\n7. Show authenticated header (user avatar, name, token balance, dropdown menu)\r\n8. Redirect unauthenticated users to login for protected features\r\n\r\n### Database â€” User Entity\r\n\r\nEnsure BradYoo.Core's `User` entity is registered in `AiDevRequestDbContext`:\r\n```\r\nUsers table: id, email, name, profile_image_url,\r\n             google_id, apple_id, line_id, kakao_id,\r\n             country_code, last_login_at, created_at, updated_at\r\n```\r\n\r\n## Out of Scope\r\n\r\n- Email/password authentication (social login only)\r\n- Two-factor authentication (2FA)\r\n- Account linking (merging multiple social accounts into one user)\r\n- Social login for providers beyond Google, Apple, LINE, Kakao (e.g., GitHub, Microsoft, Facebook)\r\n- Admin panel for managing OAuth provider configurations\r\n- Remember me / persistent sessions beyond JWT expiry\r\n- User profile editing (name, avatar â€” use social provider data)\r\n\r\n## Dependencies\r\n\r\n- **BradYoo.Core Auth** â€” needs Apple and LINE providers added\r\n- **#9** â€” Multi-language support (login page text should be translated based on detected locale)\r\n- **#13** â€” Token system (user account required for token balance)\r\n- **#15** â€” Site management (user account required for site ownership)\r\n- OAuth app registrations needed: Google Cloud Console, Apple Developer, LINE Developers, Kakao Developers\r\n- MaxMind GeoLite2 license key (free) or alternative IP geolocation service\r\n","number":18,"repository":"bradyoo12/ai-dev-request","title":"feat: social login (Google, Apple, LINE, Kakao) with geo-ordered provider buttons","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/18"},"id":"PVTI_lAHNf9fOATn4hM4JPipX","repository":"https://github.com/bradyoo12/ai-dev-request","status":"Ready","title":"feat: social login (Google, Apple, LINE, Kakao) with geo-ordered provider buttons"},{"content":{"body":"## Original Request\r\n\r\n> For each site, user should be able to search available domain and pay for new domain. AI Dev Request will own the domain.\r\n\r\n## Problem Statement\r\n\r\nAfter a user's site is deployed (#15), they only have a temporary Azure-generated URL (e.g., `https://sitename-abc123.azurecontainerapps.io`). Users need the ability to search for available custom domains, purchase them through the platform, and have them automatically configured for their site. **AI Dev Request owns all domains** on behalf of users â€” this is a managed domain service where the platform handles registration, DNS, and renewal.\r\n\r\n**Current State:**\r\n- Sites are deployed with temp Azure Container Apps URLs only (#15)\r\n- No domain search, registration, or DNS management exists\r\n- No domain registrar integration\r\n- No payment flow for domain purchases\r\n- No custom domain binding on Azure Container Apps\r\n\r\n## Success Criteria\r\n\r\n- [ ] Users can search for domain availability from their site's detail page\r\n- [ ] Domain search queries a registrar API and returns availability + pricing for multiple TLDs (.com, .net, .io, .kr, etc.)\r\n- [ ] Users can select and pay for an available domain (token-based or separate payment)\r\n- [ ] Domain is registered under **AI Dev Request's registrar account** (platform owns the domain)\r\n- [ ] DNS records are automatically configured to point to the user's Azure Container App\r\n- [ ] SSL certificate is auto-provisioned for the custom domain (Let's Encrypt or Azure managed)\r\n- [ ] Custom domain is bound to the Container App and serves traffic\r\n- [ ] Domain status, expiry date, and auto-renewal info are visible on the site detail page\r\n- [ ] Users can see all their domains in the site list and site detail views\r\n- [ ] Domain renewal is handled automatically by the platform (cost billed to user)\r\n\r\n## Visual Mockups\r\n\r\n### Domain Search (From Site Detail Page)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  My Sites > my-portfolio > Custom Domain                        â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  Current URL: https://my-portfolio-abc123.azurecontainerapps.io â”‚\r\nâ”‚  Custom Domain: (none configured)                               â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Search for a domain                                            â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚\r\nâ”‚  â”‚  my-portfolio                    [.com â–¾]  [Search]  â”‚       â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Search Results                                                 â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  â”‚ Domain                   â”‚ Status    â”‚ Price/yr â”‚ Action  â”‚  â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚\r\nâ”‚  â”‚ my-portfolio.com         â”‚ ğŸ”´ Taken  â”‚ â€”        â”‚ â€”       â”‚  â”‚\r\nâ”‚  â”‚ my-portfolio.net         â”‚ ğŸŸ¢ Avail  â”‚ $12.99   â”‚ [Buy]   â”‚  â”‚\r\nâ”‚  â”‚ my-portfolio.io          â”‚ ğŸŸ¢ Avail  â”‚ $39.99   â”‚ [Buy]   â”‚  â”‚\r\nâ”‚  â”‚ my-portfolio.dev         â”‚ ğŸŸ¢ Avail  â”‚ $14.99   â”‚ [Buy]   â”‚  â”‚\r\nâ”‚  â”‚ my-portfolio.kr          â”‚ ğŸŸ¢ Avail  â”‚ $19.99   â”‚ [Buy]   â”‚  â”‚\r\nâ”‚  â”‚ my-portfolio.app         â”‚ ğŸ”´ Taken  â”‚ â€”        â”‚ â€”       â”‚  â”‚\r\nâ”‚  â”‚ myportfolio.com          â”‚ ğŸŸ¢ Avail  â”‚ $11.99   â”‚ [Buy]   â”‚  â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  ğŸ’¡ Domains are registered and managed by AI Dev Request.       â”‚\r\nâ”‚     You get full use of the domain for your site.               â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Domain Purchase Confirmation\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Purchase Domain                    â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                     â”‚\r\nâ”‚  Domain:  my-portfolio.dev          â”‚\r\nâ”‚  Price:   $14.99 / year             â”‚\r\nâ”‚                                     â”‚\r\nâ”‚  What's included:                   â”‚\r\nâ”‚  âœ“ Domain registration (1 year)     â”‚\r\nâ”‚  âœ“ Auto-renewal                     â”‚\r\nâ”‚  âœ“ DNS configuration                â”‚\r\nâ”‚  âœ“ SSL certificate (free)           â”‚\r\nâ”‚  âœ“ Connected to your site           â”‚\r\nâ”‚                                     â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚\r\nâ”‚  Payment                            â”‚\r\nâ”‚                                     â”‚\r\nâ”‚  â—‹ Pay with tokens                  â”‚\r\nâ”‚     ğŸª™ 1,499 tokens ($14.99)        â”‚\r\nâ”‚     Balance: ğŸª™ 550 tokens          â”‚\r\nâ”‚     âš ï¸ Insufficient â€” need 949 more â”‚\r\nâ”‚                                     â”‚\r\nâ”‚  â— Pay with card                    â”‚\r\nâ”‚     [ğŸ’³ **** 4242]  [Change]        â”‚\r\nâ”‚                                     â”‚\r\nâ”‚       [Cancel]  [Purchase $14.99]   â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Site Detail â€” With Domain Configured\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Site Details: my-portfolio                                     â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  URLs                                                           â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  Custom Domain:  ğŸŸ¢ https://my-portfolio.dev                    â”‚\r\nâ”‚  Preview URL:    https://my-portfolio-abc123.azure...            â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Domain Details                                                 â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  Domain:         my-portfolio.dev                               â”‚\r\nâ”‚  Registered:     2026-02-06                                     â”‚\r\nâ”‚  Expires:        2027-02-06                                     â”‚\r\nâ”‚  Auto-Renewal:   âœ… Enabled ($14.99/yr)                         â”‚\r\nâ”‚  SSL:            âœ… Active (managed)                             â”‚\r\nâ”‚  DNS Status:     âœ… Propagated                                   â”‚\r\nâ”‚  Owner:          AI Dev Request (managed for you)               â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  [ğŸ”— Open Site]  [âš™ï¸ DNS Settings]  [âŒ Remove Domain]          â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Site List Card â€” With Domain\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  ğŸŸ¢ my-portfolio                                          â”‚\r\nâ”‚  Created: 2026-02-06  â€¢  Type: React + Vite               â”‚\r\nâ”‚                                                           â”‚\r\nâ”‚  ğŸŒ https://my-portfolio.dev                               â”‚\r\nâ”‚  ğŸ“ https://my-portfolio-abc123.azurecontainerapps.io      â”‚\r\nâ”‚                                                           â”‚\r\nâ”‚  Domain: my-portfolio.dev  â€¢  Expires: 2027-02-06         â”‚\r\nâ”‚                                                           â”‚\r\nâ”‚  [ğŸ”— Open Site]  [ğŸ“‹ Details]  [ğŸ—‘ï¸ Delete]                â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Domain Setup Progress\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  ğŸŒ Setting up my-portfolio.dev...                              â”‚\r\nâ”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  âœ… Payment processed                                            â”‚\r\nâ”‚  âœ… Domain registered: my-portfolio.dev                          â”‚\r\nâ”‚  âœ… DNS records created (A, CNAME, TXT)                          â”‚\r\nâ”‚  â³ SSL certificate provisioning...                              â”‚\r\nâ”‚  â—‹  Binding domain to Container App                             â”‚\r\nâ”‚  â—‹  Verifying site is live                                      â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  âš ï¸ DNS propagation may take up to 24 hours.                    â”‚\r\nâ”‚     Your site is accessible via the preview URL in the meantime.â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Domain Registrar Integration\r\n\r\nUse a registrar API that supports programmatic registration under a single account:\r\n- **Recommended:** Cloudflare Registrar API (at-cost pricing, good API)\r\n- **Alternatives:** Namecheap API, GoDaddy API, Google Domains API\r\n\r\nAll domains are registered under **AI Dev Request's registrar account**. The platform acts as the domain owner and manages DNS on behalf of users.\r\n\r\n### Backend â€” New Entities\r\n\r\n```\r\nDomain:\r\n  id, site_id (FK to DevRequest), user_id, domain_name, tld,\r\n  registrar, registrar_domain_id, status (pending/active/expired/cancelled),\r\n  registered_at, expires_at, auto_renew, annual_cost_usd,\r\n  ssl_status (pending/active/failed), dns_status (pending/propagated/failed),\r\n  created_at, updated_at\r\n\r\nDomainTransaction:\r\n  id, domain_id, type (purchase/renewal/refund), amount_usd,\r\n  payment_method (tokens/card), token_amount, description, created_at\r\n```\r\n\r\n### Backend â€” New Endpoints\r\n\r\n- `GET /api/domains/search?query={name}&tlds=com,net,io` â€” Search domain availability\r\n- `POST /api/sites/{siteId}/domain` â€” Purchase and configure domain for a site\r\n- `GET /api/sites/{siteId}/domain` â€” Get domain details for a site\r\n- `DELETE /api/sites/{siteId}/domain` â€” Remove custom domain (does not cancel registration)\r\n- `GET /api/domains` â€” List all user's domains\r\n- `POST /api/domains/{id}/renew` â€” Manually trigger renewal\r\n\r\n### Backend â€” Domain Setup Pipeline\r\n\r\nAfter purchase:\r\n1. **Register domain** via registrar API under platform account\r\n2. **Create DNS records** â€” A record / CNAME pointing to Azure Container App\r\n3. **Add custom domain** to Azure Container App (`az containerapp hostname add`)\r\n4. **Provision SSL** â€” Azure managed certificate or Let's Encrypt\r\n5. **Bind SSL** to custom domain\r\n6. **Verify** â€” Health check on the custom domain URL\r\n7. **Update status** â€” Mark domain as active, store in database\r\n\r\n### Frontend\r\n\r\n- Add \"Custom Domain\" section to Site Detail page\r\n- Domain search component with TLD dropdown and results table\r\n- Purchase flow with token or card payment options\r\n- Domain setup progress indicator (poll status endpoint)\r\n- Domain info display on site list cards and detail page\r\n- Renewal reminders/notifications when domain is expiring\r\n\r\n### DNS Configuration (Auto-Generated)\r\n\r\n```\r\nType    Name                    Value                               TTL\r\nA       my-portfolio.dev        <Container App IP>                  300\r\nCNAME   www.my-portfolio.dev    my-portfolio-abc123.azure...io      300\r\nTXT     my-portfolio.dev        azure-domain-verification=...       300\r\n```\r\n\r\n## Out of Scope\r\n\r\n- Domain transfer (moving existing domains into the platform)\r\n- Subdomain management beyond www\r\n- Advanced DNS record editing by users (MX, SPF, DKIM, etc.)\r\n- Domain ownership transfer to users (platform always owns)\r\n- Email hosting / email forwarding on the domain\r\n- WHOIS privacy (use registrar default â€” platform info)\r\n- Multi-domain per site (one custom domain per site for MVP)\r\n- Domain marketplace or reselling\r\n\r\n## Dependencies\r\n\r\n- **#15** â€” Azure resource group and site deployment (provides Container App and site list page)\r\n- **#13** â€” Token system (for token-based domain payment option)\r\n- Domain registrar account setup (Cloudflare or alternative)\r\n- Payment gateway integration (for card payments â€” separate concern)\r\n- Azure Container Apps custom domain + managed certificate support\r\n","number":16,"repository":"bradyoo12/ai-dev-request","title":"feat: domain search, purchase, and auto-configuration for user sites","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/16"},"id":"PVTI_lAHNf9fOATn4hM4JPiJl","repository":"https://github.com/bradyoo12/ai-dev-request","status":"Ready","title":"feat: domain search, purchase, and auto-configuration for user sites"},{"content":{"body":"## Original Request\r\n\r\n> User should have setting menu containing 'Usage' where they can see token usage transactions.\r\n\r\n## Problem Statement\r\n\r\nWhile #13 defines the token balance system and #14 introduces per-stage token deductions, there is no dedicated **Usage** page where users can view a detailed breakdown of how their tokens have been spent. Users need a clear, filterable view of all token transactions â€” credits (purchases, welcome bonus) and debits (design, plan, build actions) â€” so they can understand their consumption patterns and manage their budget.\r\n\r\nThe settings menu (established in #13 and #19) needs a dedicated **Usage** tab that provides:\r\n- A summary dashboard of token spending over time\r\n- A detailed, filterable transaction log\r\n- Per-project usage breakdown\r\n- Usage trends and remaining balance projection\r\n\r\n**Current State:**\r\n- No settings page exists yet (planned in #13)\r\n- `TokenTransaction` entity is planned (#13) but not built\r\n- Token deduction per stage is planned (#14) but not built\r\n- Payment history is covered in #19 (monetary transactions) â€” this ticket focuses on **token usage** (consumption view)\r\n\r\n## Success Criteria\r\n\r\n- [ ] Settings menu includes a \"Usage\" tab/section\r\n- [ ] Usage page shows a summary card with: current balance, tokens used this month, tokens purchased this month\r\n- [ ] A usage chart visualizes daily/weekly/monthly token consumption over time\r\n- [ ] A detailed transaction table lists all token debits and credits with filters\r\n- [ ] Each transaction shows: date, action type, project name, tokens spent/earned, resulting balance\r\n- [ ] Users can filter transactions by: type (credit/debit), action (design/plan/build/purchase/bonus), date range, project\r\n- [ ] Per-project usage breakdown shows total tokens spent on each project\r\n- [ ] Export option for transaction data (CSV download)\r\n- [ ] Page loads quickly with pagination for large transaction histories\r\n\r\n## Visual Mockups\r\n\r\n### Settings Navigation (with Usage tab)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Settings              â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚\r\nâ”‚  ğŸª™ Token Balance      â”‚\r\nâ”‚  ğŸ“Š Usage         â—€â”€â”€ â”‚\r\nâ”‚  ğŸ’³ Payment Methods    â”‚\r\nâ”‚  ğŸ“œ Payment History    â”‚\r\nâ”‚  ğŸŒ Language           â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Usage Page â€” Summary & Chart\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Settings > Usage                                               â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\r\nâ”‚  â”‚ Current Balance  â”‚ â”‚ Used This Month  â”‚ â”‚ Added This Monthâ”‚  â”‚\r\nâ”‚  â”‚                  â”‚ â”‚                  â”‚ â”‚                 â”‚  â”‚\r\nâ”‚  â”‚ ğŸª™ 743 tokens    â”‚ â”‚ ğŸ”» 457 tokens    â”‚ â”‚ ğŸ”º 1,200 tokens â”‚  â”‚\r\nâ”‚  â”‚ â‰ˆ $7.43          â”‚ â”‚ across 4 projectsâ”‚ â”‚ (purchase+bonus)â”‚  â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Token Usage Over Time             [This Month â–¾] [Daily â–¾]    â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  500 â”¤                                                          â”‚\r\nâ”‚  400 â”¤          â–ˆâ–ˆ                                              â”‚\r\nâ”‚  300 â”¤    â–ˆâ–ˆ    â–ˆâ–ˆ â–ˆâ–ˆ                                           â”‚\r\nâ”‚  200 â”¤    â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ                                           â”‚\r\nâ”‚  100 â”¤ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ                                       â”‚\r\nâ”‚    0 â”¼â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€                            â”‚\r\nâ”‚       1  3  5  7  9  11 13 15                                   â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â–  Design (50/ea)  â–  Plan (100/ea)  â–  Build (300/ea)           â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Usage Page â€” Transaction Log\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Transaction History                               [Export CSV] â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  Filter: [All Types â–¾] [All Actions â–¾] [All Projects â–¾]        â”‚\r\nâ”‚          [Feb 1, 2026] to [Feb 6, 2026]  [Apply]               â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  â”‚ Date       â”‚ Action      â”‚ Project          â”‚ Tokensâ”‚ Bal  â”‚ â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤ â”‚\r\nâ”‚  â”‚ Feb 6 14:22â”‚ ğŸ”µ Design   â”‚ my-portfolio     â”‚   -50 â”‚  743 â”‚ â”‚\r\nâ”‚  â”‚ Feb 5 11:05â”‚ ğŸŸ  Plan     â”‚ invoice-app      â”‚  -100 â”‚  793 â”‚ â”‚\r\nâ”‚  â”‚ Feb 5 09:30â”‚ ğŸ”µ Design   â”‚ invoice-app      â”‚   -50 â”‚  893 â”‚ â”‚\r\nâ”‚  â”‚ Feb 3 16:40â”‚ ğŸŸ¢ Purchase â”‚ â€”                â”‚  +500 â”‚  943 â”‚ â”‚\r\nâ”‚  â”‚ Feb 2 20:15â”‚ ğŸ”´ Build    â”‚ chatbot-landing  â”‚  -300 â”‚  443 â”‚ â”‚\r\nâ”‚  â”‚ Feb 2 10:08â”‚ ğŸŸ  Plan     â”‚ chatbot-landing  â”‚  -100 â”‚  743 â”‚ â”‚\r\nâ”‚  â”‚ Feb 1 14:55â”‚ ğŸ”µ Design   â”‚ chatbot-landing  â”‚   -50 â”‚  843 â”‚ â”‚\r\nâ”‚  â”‚ Feb 1 08:00â”‚ ğŸŸ¢ Purchase â”‚ â€”                â”‚  +200 â”‚  893 â”‚ â”‚\r\nâ”‚  â”‚ Jan 28     â”‚ ğŸ Bonus    â”‚ â€”                â”‚ +1000 â”‚  693 â”‚ â”‚ â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜ â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Showing 1â€“9 of 9 transactions              [â† Prev] [Next â†’]  â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Usage Page â€” Per-Project Breakdown\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Usage by Project                                               â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â”‚ Project            â”‚ Design â”‚ Plan â”‚ Build â”‚ Total  â”‚        â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚\r\nâ”‚  â”‚ chatbot-landing    â”‚  50    â”‚ 100  â”‚  300  â”‚ 450 ğŸª™ â”‚        â”‚\r\nâ”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     â”‚        â”‚\r\nâ”‚  â”‚                                                     â”‚        â”‚\r\nâ”‚  â”‚ invoice-app        â”‚  50    â”‚ 100  â”‚   â€”   â”‚ 150 ğŸª™ â”‚        â”‚\r\nâ”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                  â”‚        â”‚\r\nâ”‚  â”‚                                                     â”‚        â”‚\r\nâ”‚  â”‚ my-portfolio       â”‚  50    â”‚  â€”   â”‚   â€”   â”‚  50 ğŸª™ â”‚        â”‚\r\nâ”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                              â”‚        â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Total consumed: 650 tokens across 3 projects                   â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Filter â€” Action Type Dropdown\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ All Actions    â–¾ â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ â˜‘ All            â”‚\r\nâ”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚\r\nâ”‚ â˜ ğŸ”µ Design     â”‚\r\nâ”‚ â˜ ğŸŸ  Plan       â”‚\r\nâ”‚ â˜ ğŸ”´ Build      â”‚\r\nâ”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚\r\nâ”‚ â˜ ğŸŸ¢ Purchase   â”‚\r\nâ”‚ â˜ ğŸ Bonus      â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Backend â€” Endpoints\r\n\r\n- `GET /api/settings/usage/summary` â€” Returns current balance, tokens used this period, tokens added this period\r\n- `GET /api/settings/usage/transactions?type=&action=&projectId=&from=&to=&page=&pageSize=` â€” Paginated, filterable transaction list\r\n- `GET /api/settings/usage/by-project` â€” Aggregated token usage grouped by project\r\n- `GET /api/settings/usage/chart?period=daily|weekly|monthly&from=&to=` â€” Aggregated data points for the usage chart\r\n- `GET /api/settings/usage/export?format=csv&from=&to=` â€” CSV export of transactions\r\n\r\n### Backend â€” Query Patterns\r\n\r\nAll queries filter on `TokenTransaction` table by `userId`:\r\n\r\n**Summary:** `SELECT SUM(amount) ... WHERE created_at >= @monthStart GROUP BY type`\r\n\r\n**Chart data:** `SELECT DATE(created_at), action, SUM(ABS(amount)) ... GROUP BY DATE(created_at), action ORDER BY date`\r\n\r\n**By project:** `SELECT reference_id, action, SUM(ABS(amount)) ... WHERE type = 'debit' GROUP BY reference_id, action`\r\n\r\nEnsure indexes on `TokenTransaction`: `(user_id, created_at)`, `(user_id, action)`, `(user_id, reference_id)`\r\n\r\n### Frontend\r\n\r\n- Add \"Usage\" tab to Settings page navigation (between Token Balance and Payment Methods)\r\n- **Summary cards** â€” 3 stat cards at the top (balance, used, added)\r\n- **Chart component** â€” Use a lightweight chart library (e.g., `recharts` or `chart.js`) for the bar/area chart with color-coded action types\r\n- **Transaction table** â€” Sortable, paginated table with multi-select filter dropdowns for type, action, project, and date range picker\r\n- **Project breakdown** â€” Horizontal stacked bar chart showing per-project usage by stage\r\n- **CSV export** â€” Button triggers download via the export endpoint\r\n- **Responsive** â€” Table collapses to card layout on mobile\r\n\r\n### Relationship to Other Tickets\r\n\r\nThis ticket provides the **read-only consumption view**. Related tickets handle the write side:\r\n- **#13** defines `TokenTransaction` entity and balance tracking\r\n- **#14** creates transactions when tokens are spent on design/plan/build\r\n- **#19** covers payment history (monetary view â€” separate from token usage view)\r\n\r\nThis page reads from the same `TokenTransaction` table but presents it from a **usage/consumption perspective** rather than a payment/billing perspective.\r\n\r\n## Out of Scope\r\n\r\n- Usage alerts or notifications (e.g., \"You've used 80% of your tokens\")\r\n- Usage quotas or spending limits\r\n- Admin view of all users' usage (admin analytics â€” separate ticket)\r\n- Predictive usage forecasting (\"At this rate, tokens will last X days\")\r\n- Real-time usage updates via WebSocket (polling or page refresh is sufficient)\r\n- Token usage breakdown by AI model or API token count (show platform token cost only)\r\n\r\n## Dependencies\r\n\r\n- **#13** â€” Token system (`TokenBalance`, `TokenTransaction` entities)\r\n- **#14** â€” Token deduction per stage (populates transaction records)\r\n- **#18** â€” User authentication (user context for querying transactions)\r\n- **#19** â€” Settings page structure and navigation (Usage tab fits within existing settings layout)\r\n","number":20,"repository":"bradyoo12/ai-dev-request","title":"feat: add Usage page in settings to view token consumption transactions","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/20"},"id":"PVTI_lAHNf9fOATn4hM4JPjuh","linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/25"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: add Usage page in settings to view token consumption transactions"},{"content":{"body":"## Original Request\r\n\r\n> One of user's setting menu pages should hold the user's credit card info or stripe info and hold option next to that for 'auto-payment when tokens left are less than 100'.\r\n\r\n## Problem Statement\r\n\r\nWhen users run low on tokens, they currently must manually navigate to the token purchase flow, select a package, and complete payment â€” interrupting their workflow. Users need a **Billing settings page** that stores their credit card / Stripe payment info and provides an **auto-top-up** option that automatically purchases tokens when their balance drops below a configurable threshold (default: 100 tokens).\r\n\r\n#19 introduces Stripe payment integration and saved payment methods, but it does not cover **automatic/recurring token replenishment**. This ticket adds the auto-top-up feature and consolidates the billing UI into a single settings page.\r\n\r\n**Current State:**\r\n- No payment methods or Stripe integration exists yet (planned in #19)\r\n- No auto-payment or auto-top-up logic\r\n- Token deductions (#14) can bring balance to zero with no automated recovery\r\n- Users hitting zero tokens are blocked from all AI actions until they manually buy more\r\n\r\n## Success Criteria\r\n\r\n- [ ] Billing settings page displays saved credit card(s) / Stripe payment methods\r\n- [ ] Users can add, remove, and set a default payment method from the billing page\r\n- [ ] An \"Auto Top-Up\" toggle is available next to the saved payment method\r\n- [ ] When enabled, auto top-up triggers when token balance drops below the threshold (default: 100)\r\n- [ ] Users can configure the threshold (e.g., 50, 100, 200) and the top-up package (e.g., 500, 1000 tokens)\r\n- [ ] Auto top-up charges the user's default payment method via Stripe automatically\r\n- [ ] A confirmation notification is shown after auto top-up completes (in-app + optional email)\r\n- [ ] Auto top-up failures (expired card, insufficient funds) notify the user and disable auto-top-up\r\n- [ ] Auto top-up transactions appear in Usage (#20) and Payment History (#19) like normal purchases\r\n- [ ] Users can disable auto top-up at any time\r\n\r\n## Visual Mockups\r\n\r\n### Settings > Billing Page\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Settings > Billing                                             â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  Payment Method                                    [+ Add Card] â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\r\nâ”‚  â”‚  ğŸ’³ Visa â€¢â€¢â€¢â€¢ 4242              Default âœ“                  â”‚  â”‚\r\nâ”‚  â”‚  Expires 12/2028                                           â”‚  â”‚\r\nâ”‚  â”‚                                                           â”‚  â”‚\r\nâ”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚\r\nâ”‚  â”‚  â”‚  âš¡ Auto Top-Up                            [ON ğŸŸ¢]  â”‚  â”‚  â”‚\r\nâ”‚  â”‚  â”‚                                                     â”‚  â”‚  â”‚\r\nâ”‚  â”‚  â”‚  When balance drops below:  [100 tokens â–¾]          â”‚  â”‚  â”‚\r\nâ”‚  â”‚  â”‚  Automatically purchase:    [1,000 tokens / $10 â–¾]  â”‚  â”‚  â”‚\r\nâ”‚  â”‚  â”‚                                                     â”‚  â”‚  â”‚\r\nâ”‚  â”‚  â”‚  ğŸ’¡ You'll be charged $10.00 automatically when      â”‚  â”‚  â”‚\r\nâ”‚  â”‚  â”‚     your balance falls below 100 tokens.             â”‚  â”‚  â”‚\r\nâ”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚\r\nâ”‚  â”‚                                                           â”‚  â”‚\r\nâ”‚  â”‚                       [Set Default]  [Remove]              â”‚  â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\r\nâ”‚  â”‚  ğŸ’³ Mastercard â€¢â€¢â€¢â€¢ 8888                                   â”‚  â”‚\r\nâ”‚  â”‚  Expires 06/2027                                           â”‚  â”‚\r\nâ”‚  â”‚                                                           â”‚  â”‚\r\nâ”‚  â”‚                       [Set Default]  [Remove]              â”‚  â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Auto Top-Up Configuration (Expanded)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  âš¡ Auto Top-Up                              [ON ğŸŸ¢]  â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                       â”‚\r\nâ”‚  When balance drops below:                            â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚\r\nâ”‚  â”‚  100 tokens â–¾ â”‚                                    â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                     â”‚\r\nâ”‚  â”‚   50 tokens   â”‚                                    â”‚\r\nâ”‚  â”‚  100 tokens âœ“ â”‚                                    â”‚\r\nâ”‚  â”‚  200 tokens   â”‚                                    â”‚\r\nâ”‚  â”‚  500 tokens   â”‚                                    â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚\r\nâ”‚                                                       â”‚\r\nâ”‚  Automatically purchase:                              â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚\r\nâ”‚  â”‚  1,000 tokens / $10 â–¾ â”‚                            â”‚\r\nâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚\r\nâ”‚  â”‚    500 tokens /  $5   â”‚                            â”‚\r\nâ”‚  â”‚  1,000 tokens / $10 âœ“ â”‚                            â”‚\r\nâ”‚  â”‚  3,000 tokens / $25   â”‚                            â”‚\r\nâ”‚  â”‚ 10,000 tokens / $70   â”‚                            â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚\r\nâ”‚                                                       â”‚\r\nâ”‚  Charge to: ğŸ’³ Visa â€¢â€¢â€¢â€¢ 4242 (default)               â”‚\r\nâ”‚                                                       â”‚\r\nâ”‚  Monthly limit: [No limit â–¾]                          â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚\r\nâ”‚  â”‚  No limit     â”‚                                    â”‚\r\nâ”‚  â”‚  $50 / month  â”‚                                    â”‚\r\nâ”‚  â”‚  $100 / month â”‚                                    â”‚\r\nâ”‚  â”‚  $200 / month â”‚                                    â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚\r\nâ”‚                                                       â”‚\r\nâ”‚  ğŸ’¡ Auto top-up uses your default payment method.     â”‚\r\nâ”‚     You can disable this at any time.                 â”‚\r\nâ”‚                                                       â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Auto Top-Up Disabled State\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  âš¡ Auto Top-Up                             [OFF âšª]  â”‚\r\nâ”‚                                                       â”‚\r\nâ”‚  Never run out of tokens. Enable auto top-up to       â”‚\r\nâ”‚  automatically purchase tokens when your balance       â”‚\r\nâ”‚  is low.                                              â”‚\r\nâ”‚                                                       â”‚\r\nâ”‚  [Enable Auto Top-Up]                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Auto Top-Up Notification (In-App Toast)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  âš¡ Auto Top-Up Complete                   â”‚\r\nâ”‚                                           â”‚\r\nâ”‚  ğŸª™ 1,000 tokens added to your balance    â”‚\r\nâ”‚  ğŸ’³ $10.00 charged to Visa â€¢â€¢â€¢â€¢ 4242      â”‚\r\nâ”‚  Balance: ğŸª™ 1,043 tokens                 â”‚\r\nâ”‚                                           â”‚\r\nâ”‚                              [Dismiss]    â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Auto Top-Up Failed Notification\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  âš ï¸ Auto Top-Up Failed                    â”‚\r\nâ”‚                                           â”‚\r\nâ”‚  We couldn't charge your Visa â€¢â€¢â€¢â€¢ 4242.  â”‚\r\nâ”‚  Reason: Card declined                    â”‚\r\nâ”‚                                           â”‚\r\nâ”‚  Auto top-up has been paused.             â”‚\r\nâ”‚                                           â”‚\r\nâ”‚  [Update Card]  [Retry]  [Dismiss]        â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Settings Navigation (Updated)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Settings              â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚\r\nâ”‚  ğŸª™ Token Balance      â”‚\r\nâ”‚  ğŸ“Š Usage              â”‚\r\nâ”‚  ğŸ’³ Billing       â—€â”€â”€ â”‚\r\nâ”‚  ğŸ“œ Payment History    â”‚\r\nâ”‚  ğŸŒ Language           â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Backend â€” New Entity\r\n\r\n```\r\nAutoTopUpConfig:\r\n  id, user_id (unique), is_enabled, threshold (int, default 100),\r\n  token_package_id (FK), monthly_limit_usd (nullable),\r\n  monthly_spent_usd (resets monthly), payment_method_id (FK),\r\n  last_triggered_at, last_failed_at, failure_reason,\r\n  created_at, updated_at\r\n```\r\n\r\n### Backend â€” Auto Top-Up Trigger Logic\r\n\r\nIntegrate into the token deduction flow (`ITokenService.DebitTokens` from #14):\r\n\r\n```\r\nAfter deducting tokens:\r\n1. Check new balance\r\n2. If balance < user's auto_top_up threshold AND auto_top_up is enabled:\r\n   a. Check monthly limit not exceeded\r\n   b. Check last_triggered_at to prevent rapid-fire (cooldown: 1 minute)\r\n   c. Create Stripe PaymentIntent using saved default payment method\r\n   d. On success: credit tokens, create TokenTransaction, log Payment, send notification\r\n   e. On failure: log error, set last_failed_at + failure_reason, pause auto-top-up, notify user\r\n```\r\n\r\n**Important safeguards:**\r\n- **Cooldown period** â€” prevent multiple auto-charges within a short window (e.g., 1 min)\r\n- **Monthly spending cap** â€” optional limit to prevent runaway charges\r\n- **Pause on failure** â€” auto-disable after failed charge until user re-enables\r\n- **Idempotency** â€” use Stripe idempotency keys to prevent duplicate charges\r\n\r\n### Backend â€” Endpoints\r\n\r\n- `GET /api/settings/billing` â€” Get saved payment methods + auto-top-up config\r\n- `PUT /api/settings/billing/auto-topup` â€” Enable/disable and configure auto top-up\r\n- `GET /api/settings/billing/auto-topup` â€” Get current auto top-up configuration\r\n- Payment method CRUD endpoints already covered in #19\r\n\r\n### Frontend â€” Billing Settings Page\r\n\r\n- Consolidate payment method display and auto-top-up config into a single \"Billing\" page\r\n- Auto-top-up section is a card/panel within the default payment method card\r\n- Toggle switch for enable/disable\r\n- Dropdown selectors for threshold, package, and monthly limit\r\n- Toast notifications for auto-top-up success and failure\r\n- Failed state shows prominent warning with \"Update Card\" and \"Retry\" actions\r\n\r\n### Notification System\r\n\r\n- **In-app toast** â€” shown on next page load or in real-time if using WebSocket\r\n- **Email notification** (optional) â€” \"Your account was automatically charged $10.00 for 1,000 tokens\"\r\n- **Failure email** â€” \"Auto top-up failed â€” please update your payment method\"\r\n\r\n## Out of Scope\r\n\r\n- SMS notifications for auto-top-up events\r\n- Multiple auto-top-up rules (one config per user is sufficient)\r\n- Auto-top-up for domain renewals (separate from token top-up)\r\n- Scheduled/recurring token purchases on a fixed date (this is threshold-based, not time-based)\r\n- Admin ability to force-enable auto-top-up for users\r\n- Spending analytics or suggestions (\"You'd save 17% with the 3,000 token package\")\r\n\r\n## Dependencies\r\n\r\n- **#19** â€” Stripe integration and saved payment methods (auto-top-up charges the saved card)\r\n- **#13** â€” Token balance system (provides the balance to check against threshold)\r\n- **#14** â€” Token deduction per stage (triggers the balance check after each debit)\r\n- **#18** â€” User authentication (user context for billing settings)\r\n- **#20** â€” Usage page (auto-top-up transactions appear in transaction history)\r\n","number":21,"repository":"bradyoo12/ai-dev-request","title":"feat: billing settings page with saved cards and auto top-up when tokens below threshold","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/21"},"id":"PVTI_lAHNf9fOATn4hM4JPj9g","linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/35"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: billing settings page with saved cards and auto top-up when tokens below threshold"},{"content":{"body":"## Original Request\r\n\r\n> User should be able to select their Azure service plan after they are noted about the token usage.\r\n\r\n## Problem Statement\r\n\r\nIn the current build flow (#14, #15), after the user confirms the token cost for the Build stage, the platform auto-provisions Azure resources with a default configuration. Users have **no visibility into or control over the Azure hosting plan** that will run their site â€” they don't know the monthly hosting cost, performance tier, or resource allocation until after deployment.\r\n\r\nUsers need to **select an Azure service plan** (e.g., Free, Basic, Standard, Premium) **after** they see the token usage confirmation but **before** the build begins. This lets them make an informed decision about the ongoing hosting cost of their site, separate from the one-time token cost of the build.\r\n\r\n**Current Flow (planned in #14 + #15):**\r\n```\r\nToken confirmation â†’ Build starts â†’ Azure resources auto-provisioned (no choice)\r\n```\r\n\r\n**Desired Flow:**\r\n```\r\nToken confirmation â†’ Select Azure plan (with pricing) â†’ Build starts â†’ Provision selected plan\r\n```\r\n\r\n**Current State:**\r\n- #15 plans auto-provisioning with no user input on Azure tier\r\n- No Azure plan/SKU selection UI exists\r\n- No hosting cost estimation shown to user before deployment\r\n- `ProductionService` generates deployment config but doesn't expose plan choices\r\n\r\n## Success Criteria\r\n\r\n- [ ] After the token usage confirmation dialog (Build stage), users see an Azure plan selection step\r\n- [ ] Available plans show: name, monthly cost, specs (CPU, memory, scaling), and recommended use case\r\n- [ ] Users can compare plans side-by-side before choosing\r\n- [ ] The AI analysis/proposal can recommend a plan based on project complexity\r\n- [ ] Selected plan is stored on the deployment record and used when provisioning Azure resources\r\n- [ ] Users can change their plan after deployment (scale up/down) from the site detail page\r\n- [ ] Monthly hosting cost is clearly shown as a recurring charge separate from one-time token cost\r\n- [ ] Free tier option is available for testing/preview (with limitations noted)\r\n\r\n## Visual Mockups\r\n\r\n### Build Flow â€” After Token Confirmation\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Step 1 of 2: Token Cost                              âœ… Done   â”‚\r\nâ”‚  Build will use ğŸª™ 300 tokens ($3.00)                           â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Step 2 of 2: Select Hosting Plan                               â”‚\r\nâ”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Choose how your site will be hosted on Azure:                  â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  ğŸ’¡ Recommended for your project (Medium complexity): Basic     â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚\r\nâ”‚  â”‚    Free      â”‚ â”‚   Basic â­   â”‚ â”‚  Standard    â”‚ â”‚Premium â”‚ â”‚\r\nâ”‚  â”‚              â”‚ â”‚              â”‚ â”‚              â”‚ â”‚        â”‚ â”‚\r\nâ”‚  â”‚  $0/month    â”‚ â”‚  $5/month    â”‚ â”‚  $25/month   â”‚ â”‚$70/mo  â”‚ â”‚\r\nâ”‚  â”‚              â”‚ â”‚              â”‚ â”‚              â”‚ â”‚        â”‚ â”‚\r\nâ”‚  â”‚  Shared CPU  â”‚ â”‚  1 vCPU      â”‚ â”‚  2 vCPU      â”‚ â”‚4 vCPU  â”‚ â”‚\r\nâ”‚  â”‚  256MB RAM   â”‚ â”‚  0.5GB RAM   â”‚ â”‚  2GB RAM     â”‚ â”‚4GB RAM â”‚ â”‚\r\nâ”‚  â”‚  No scaling  â”‚ â”‚  No scaling  â”‚ â”‚  Auto-scale  â”‚ â”‚Auto-sc â”‚ â”‚\r\nâ”‚  â”‚  No custom   â”‚ â”‚  Custom      â”‚ â”‚  Custom      â”‚ â”‚Custom  â”‚ â”‚\r\nâ”‚  â”‚  domain      â”‚ â”‚  domain      â”‚ â”‚  domain      â”‚ â”‚domain  â”‚ â”‚\r\nâ”‚  â”‚  7-day limit â”‚ â”‚  Always on   â”‚ â”‚  Always on   â”‚ â”‚SLA 99% â”‚ â”‚\r\nâ”‚  â”‚              â”‚ â”‚              â”‚ â”‚              â”‚ â”‚        â”‚ â”‚\r\nâ”‚  â”‚  [Select]    â”‚ â”‚ [Select â­]  â”‚ â”‚  [Select]    â”‚ â”‚[Select]â”‚ â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  â“˜ Hosting is billed monthly to your payment method.            â”‚\r\nâ”‚    You can change plans anytime from Site Settings.             â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Plan Comparison Detail (Expanded on Hover/Click)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Plan Details: Basic ($5/month)                        [Close]  â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  Resources                                                      â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  CPU:            1 vCPU                                         â”‚\r\nâ”‚  Memory:         0.5 GB RAM                                     â”‚\r\nâ”‚  Storage:        1 GB                                           â”‚\r\nâ”‚  Bandwidth:      50 GB / month                                  â”‚\r\nâ”‚  Scaling:        Fixed (1 instance)                             â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Features                                                       â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  âœ… Custom domain support                                        â”‚\r\nâ”‚  âœ… SSL certificate (managed)                                    â”‚\r\nâ”‚  âœ… Always-on (no cold starts)                                   â”‚\r\nâ”‚  âŒ Auto-scaling                                                 â”‚\r\nâ”‚  âŒ SLA guarantee                                                â”‚\r\nâ”‚  âŒ Dedicated resources                                          â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Best for: Personal projects, small business sites,             â”‚\r\nâ”‚  low-traffic applications                                       â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  Azure SKU: Container Apps Consumption (Basic)                  â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚                                        [Select This Plan]       â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Combined Confirmation (Token + Plan Selected)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Confirm Build & Deploy                   â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                           â”‚\r\nâ”‚  Build Cost (one-time):                   â”‚\r\nâ”‚  ğŸª™ 300 tokens ($3.00)                    â”‚\r\nâ”‚                                           â”‚\r\nâ”‚  Hosting Plan (monthly):                  â”‚\r\nâ”‚  ğŸ“¦ Basic â€” $5.00/month                   â”‚\r\nâ”‚  Billed to: ğŸ’³ Visa â€¢â€¢â€¢â€¢ 4242             â”‚\r\nâ”‚                                           â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚\r\nâ”‚  Total today:  $3.00 (tokens)             â”‚\r\nâ”‚  Then:         $5.00/month (hosting)      â”‚\r\nâ”‚                                           â”‚\r\nâ”‚       [Cancel]  [â–¶ Build & Deploy]        â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Site Detail â€” Change Plan\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Site Details: my-portfolio                                     â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                 â”‚\r\nâ”‚  Hosting Plan                                                   â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚\r\nâ”‚  Current Plan:     ğŸ“¦ Basic                                     â”‚\r\nâ”‚  Monthly Cost:     $5.00/month                                  â”‚\r\nâ”‚  Next Billing:     Mar 6, 2026                                  â”‚\r\nâ”‚  Resources:        1 vCPU, 0.5GB RAM                            â”‚\r\nâ”‚                                                                 â”‚\r\nâ”‚  [Change Plan]  [Cancel Plan]                                   â”‚\r\nâ”‚                                                                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Change Plan Dialog (From Site Detail)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Change Hosting Plan                      â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                           â”‚\r\nâ”‚  Current: ğŸ“¦ Basic ($5/mo)               â”‚\r\nâ”‚                                           â”‚\r\nâ”‚  Switch to:                               â”‚\r\nâ”‚  â—‹ Free      $0/mo   (shared, 7-day)     â”‚\r\nâ”‚  â— Standard  $25/mo  (2 vCPU, auto-scale)â”‚\r\nâ”‚  â—‹ Premium   $70/mo  (4 vCPU, SLA)       â”‚\r\nâ”‚                                           â”‚\r\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚\r\nâ”‚  Change takes effect immediately.         â”‚\r\nâ”‚  Prorated billing for this month.         â”‚\r\nâ”‚                                           â”‚\r\nâ”‚         [Cancel]  [Change Plan]           â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Backend â€” Azure Plan Definitions\r\n\r\nDefine hosting plans as a configurable entity (or config file):\r\n\r\n```\r\nAzureHostingPlan:\r\n  id, name, display_name, monthly_cost_usd, vcpu, memory_gb,\r\n  storage_gb, bandwidth_gb, supports_custom_domain, supports_autoscale,\r\n  supports_sla, max_instances, azure_sku, container_app_workload_profile,\r\n  description, best_for, is_active, sort_order\r\n```\r\n\r\n**Default Plans:**\r\n\r\n| Plan | Monthly | vCPU | RAM | Azure SKU | Key Limits |\r\n|------|---------|------|-----|-----------|------------|\r\n| Free | $0 | Shared | 256MB | Consumption (free tier) | 7-day expiry, no custom domain |\r\n| Basic | $5 | 1 | 0.5GB | Consumption (basic) | No scaling, custom domain |\r\n| Standard | $25 | 2 | 2GB | Dedicated (D4) | Auto-scale 1-3, SLA |\r\n| Premium | $70 | 4 | 4GB | Dedicated (D8) | Auto-scale 1-10, 99.9% SLA |\r\n\r\n### Backend â€” Plan Selection in Build Flow\r\n\r\nModify the build endpoint to accept a plan selection:\r\n\r\n```\r\nPOST /api/requests/{id}/build\r\nBody: { \"hostingPlanId\": \"basic\" }\r\n```\r\n\r\n**Flow:**\r\n1. Token balance check (from #14)\r\n2. Validate selected hosting plan\r\n3. If paid plan â†’ verify payment method on file and create Stripe subscription for monthly billing\r\n4. Execute AI build (ProductionService)\r\n5. Provision Azure resources using the selected plan's SKU/configuration\r\n6. Store selected plan on Deployment record\r\n\r\n### Backend â€” AI Plan Recommendation\r\n\r\nAfter the analysis stage, include a recommended plan in the analysis result based on project complexity:\r\n- Simple â†’ Free or Basic\r\n- Medium â†’ Basic or Standard\r\n- Complex â†’ Standard or Premium\r\n- Enterprise â†’ Premium\r\n\r\n### Backend â€” Plan Change After Deployment\r\n\r\n- `PUT /api/sites/{siteId}/plan` â€” Change hosting plan\r\n- Triggers Azure resource scaling (update Container App workload profile)\r\n- Prorates billing via Stripe (upgrade: charge difference, downgrade: credit)\r\n- Store plan change history for auditing\r\n\r\n### Backend â€” New Endpoints\r\n\r\n- `GET /api/hosting/plans` â€” List available Azure hosting plans with pricing\r\n- `GET /api/hosting/plans/{id}` â€” Plan detail\r\n- `GET /api/requests/{id}/recommended-plan` â€” AI-recommended plan based on analysis\r\n- `PUT /api/sites/{siteId}/plan` â€” Change plan for existing site\r\n- `DELETE /api/sites/{siteId}/plan` â€” Cancel hosting (take site offline)\r\n\r\n### Frontend\r\n\r\n- Add plan selection step between token confirmation and build execution\r\n- Show recommended plan highlighted with a star based on AI analysis\r\n- Plan comparison cards with key specs and \"Best for\" descriptions\r\n- Combined confirmation dialog showing token cost + monthly hosting cost\r\n- Site detail page: show current plan, billing date, change/cancel options\r\n- Change plan dialog with prorated billing explanation\r\n\r\n### Billing Integration\r\n\r\n- **Free plan:** No Stripe subscription needed\r\n- **Paid plans:** Create Stripe Subscription with monthly recurring price\r\n- **Plan changes:** Use Stripe Subscription update with proration\r\n- **Cancellation:** Cancel Stripe Subscription, optionally keep site running until period end\r\n\r\n## Out of Scope\r\n\r\n- Custom/enterprise plan configuration (contact sales)\r\n- Reserved instance pricing or annual commitment discounts\r\n- Multi-region deployment options per plan\r\n- Resource usage monitoring dashboards (CPU, memory metrics)\r\n- Automatic plan recommendations based on traffic patterns\r\n- Spot/preemptible instance options for cost savings\r\n- Plan-specific SLA enforcement or uptime monitoring\r\n\r\n## Dependencies\r\n\r\n- **#14** â€” Token cost confirmation (plan selection happens right after this step)\r\n- **#15** â€” Azure deployment (needs to accept plan parameter for resource provisioning)\r\n- **#19** â€” Stripe payments (monthly hosting billed via Stripe Subscription)\r\n- **#21** â€” Billing settings (hosting charges use saved payment method)\r\n- **#18** â€” User authentication\r\n","number":23,"repository":"bradyoo12/ai-dev-request","title":"feat: Azure hosting plan selection after token usage confirmation","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/23"},"id":"PVTI_lAHNf9fOATn4hM4JPkHy","linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/37"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: Azure hosting plan selection after token usage confirmation"},{"content":{"body":"## Summary\r\n\r\nAfter AI generates a project, automatically run the code in a headless browser, verify it works, identify visual/functional bugs, and fix them before delivering to the user. Inspired by Replit Agent 3's \"self-healing\" build verification approach.\r\n\r\n## Problem\r\n\r\nCurrently our build pipeline generates code and delivers it as-is. There's no automated quality gate â€” the user receives whatever the AI produces on the first pass. Competitors like Replit Agent 3 run autonomous browser-based testing loops where the agent periodically tests its own output, generates a bug report, and iterates until the code works correctly.\r\n\r\n## Proposed Solution\r\n\r\nAdd a **post-build verification step** to the build pipeline:\r\n\r\n1. After code generation completes, spin up the project in a sandboxed environment\r\n2. Use Playwright (already in our test stack) to navigate the generated app\r\n3. AI analyzes screenshots + console output for errors, layout issues, broken features\r\n4. If issues found â†’ AI generates fixes â†’ re-test (max 3 iterations)\r\n5. Only deliver to user after verification passes or max iterations reached\r\n\r\n### Architecture\r\n\r\n```\r\nBuild Pipeline (current)          Build Pipeline (proposed)\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r\nRequest â†’ Analysis â†’              Request â†’ Analysis â†’\r\n  Proposal â†’ Build â†’ Deliver        Proposal â†’ Build â†’\r\n                                      â”Œâ†’ Verify (Playwright) â†’\r\n                                      â”‚  AI Bug Report â†’\r\n                                      â”‚  Auto-Fix â†’ Re-verify â”€â”\r\n                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n                                      â†’ Deliver (verified)\r\n```\r\n\r\n### Key Components\r\n- **Sandbox runner**: Spin up generated project (Node/Vite) in isolated environment\r\n- **Playwright verifier**: Navigate pages, check console errors, capture screenshots\r\n- **AI reviewer**: Claude analyzes test results and generates fixes\r\n- **Iteration controller**: Max 3 fix cycles, then deliver with quality report\r\n\r\n## Competitive Context\r\n\r\n| Platform | Self-Testing? | Approach |\r\n|----------|-------------|----------|\r\n| Replit Agent 3 | Yes | Browser-based testing + auto-fix loop, 200min autonomy |\r\n| Bolt.new | Partial | Live preview but no auto-fix loop |\r\n| v0.dev | No | Manual refinement only |\r\n| **AI Dev Request** | **No (proposed)** | **Playwright + Claude verification loop** |\r\n\r\n## Impact\r\n\r\n- **User satisfaction**: Significantly fewer broken projects delivered\r\n- **Trust**: Users see quality scores/reports alongside their projects\r\n- **Differentiation**: Most competitors don't have automated self-healing\r\n\r\n## References\r\n\r\n- [Replit Agent 3: Self-Healing Code](https://leaveit2ai.com/ai-tools/code-development/replit-agent-v3)\r\n- [Best AI Coding Agents 2026](https://www.faros.ai/blog/best-ai-coding-agents-2026)\r\n","number":26,"repository":"bradyoo12/ai-dev-request","title":"feat: AI self-testing build verification loop with Playwright auto-fix","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/26"},"id":"PVTI_lAHNf9fOATn4hM4JPmR0","labels":["suggestion"],"linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/39"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: AI self-testing build verification loop with Playwright auto-fix"},{"content":{"body":"## Summary\r\n\r\nExpand the platform's project generation capabilities to include React Native/Expo mobile apps, allowing users to request and receive cross-platform mobile applications alongside web apps. Users can preview generated mobile apps via QR code on their phones.\r\n\r\n## Problem\r\n\r\nOur platform currently only generates web applications (React + Node.js). The mobile app market is massive, and users frequently want both web and mobile versions of their ideas. Competitors like Replit now offer mobile app generation with instant QR code previews on physical devices.\r\n\r\nWithout mobile support, we lose users who need mobile apps to competitors that handle both web and mobile from a single prompt.\r\n\r\n## Proposed Solution\r\n\r\nAdd **mobile app generation** as a new project type:\r\n\r\n1. During analysis, AI detects when a request is better suited for mobile (or both web + mobile)\r\n2. New template category: React Native + Expo\r\n3. Generated mobile projects include navigation, screens, and native components\r\n4. QR code preview: user scans code to see the app on their device via Expo Go\r\n\r\n### New Templates\r\n\r\n```\r\ntemplates/\r\nâ”œâ”€â”€ web-app/          # Existing\r\nâ”œâ”€â”€ api-server/       # Existing\r\nâ”œâ”€â”€ automation/       # Existing\r\nâ”œâ”€â”€ mobile-app/       # NEW: React Native + Expo\r\nâ”‚   â”œâ”€â”€ scaffold/\r\nâ”‚   â”‚   â”œâ”€â”€ App.tsx\r\nâ”‚   â”‚   â”œâ”€â”€ app.json\r\nâ”‚   â”‚   â”œâ”€â”€ navigation/\r\nâ”‚   â”‚   â”œâ”€â”€ screens/\r\nâ”‚   â”‚   â””â”€â”€ components/\r\nâ”‚   â””â”€â”€ template.json\r\nâ””â”€â”€ full-stack/       # NEW: Web + Mobile + API\r\n```\r\n\r\n### Analysis Enhancement\r\n- AI auto-detects mobile-suitable requests (e.g., \"I need an app for tracking my workouts\")\r\n- Proposes mobile, web, or both based on requirements\r\n- Mobile-specific analysis: platform targets (iOS/Android), device features (camera, GPS, push notifications)\r\n\r\n### Tech Stack for Mobile Generation\r\n- **Framework**: React Native + Expo (managed workflow)\r\n- **Navigation**: React Navigation\r\n- **State**: Zustand (same as web, shared knowledge)\r\n- **UI**: React Native Paper or NativeWind (Tailwind for RN)\r\n\r\n### QR Preview Flow\r\n```\r\nBuild Complete â†’ Generate Expo project â†’\r\n  Start Expo dev server â†’ Generate QR code â†’\r\n  User scans with Expo Go â†’ Live preview on phone\r\n```\r\n\r\n## Competitive Context\r\n\r\n| Platform | Mobile Generation? | Approach |\r\n|----------|-------------------|----------|\r\n| Replit | Yes | Expo + QR code preview, full deploy |\r\n| Bolt.new | Partial | WebView wrappers possible |\r\n| v0.dev | No | Web components only |\r\n| Lovable | No | Web only |\r\n| **AI Dev Request** | **No (proposed)** | **React Native/Expo + QR preview** |\r\n\r\n## Impact\r\n\r\n- **Market expansion**: Capture mobile app development requests (huge market)\r\n- **Differentiation**: Few AI builders do native mobile well\r\n- **Revenue**: Mobile projects are typically more complex = more tokens consumed\r\n- **User value**: One platform for all their app needs\r\n\r\n## Token Cost\r\n- Mobile analysis: Same as web (10 tokens)\r\n- Mobile proposal: Same as web (20 tokens)\r\n- Mobile build: 60 tokens (vs 50 for web, slightly more complex)\r\n- Full-stack (web + mobile): 90 tokens (bundled discount)\r\n\r\n## References\r\n\r\n- [Replit Mobile App Preview & Deployment](https://leaveit2ai.com/ai-tools/code-development/replit-agent-v3)\r\n- [Best AI App Builders 2026](https://replit.com/discover/best-ai-app-builder)\r\n- [Expo Documentation](https://docs.expo.dev/)\r\n","number":28,"repository":"bradyoo12/ai-dev-request","title":"feat: Mobile app generation with React Native/Expo and QR code preview","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/28"},"id":"PVTI_lAHNf9fOATn4hM4JPmSQ","labels":["suggestion"],"linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/42"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"feat: Mobile app generation with React Native/Expo and QR code preview"},{"content":{"body":"## Original Request\r\n\r\n> On Google search page list, show attractive description like 'AI build', 'free AI token', 'build your own AI site'\r\n\r\n## Problem Statement\r\n\r\nWhen users search for our platform on Google, the search result listing is unattractive and uninformative. The current `index.html` has:\r\n- **Title**: Just `\"frontend\"` â€” no branding or keywords\r\n- **Meta description**: Completely missing â€” Google auto-generates a random snippet\r\n- **No Open Graph tags**: Poor appearance when shared on social media\r\n- **No structured data**: Missing rich snippet opportunities\r\n\r\nThis means Google displays something like:\r\n```\r\nfrontend\r\nhttps://ai-dev-request.example.com\r\n[random auto-generated snippet from page JS content]\r\n```\r\n\r\nInstead of an attractive, click-worthy result.\r\n\r\n## Success Criteria\r\n\r\n- [ ] Google search listing shows a compelling title with keywords (e.g., \"AI Dev Request â€” Build Software with AI\")\r\n- [ ] Meta description includes attractive phrases like \"AI build\", \"free AI token\", \"build your own AI site\"\r\n- [ ] Open Graph tags are present for social media sharing (og:title, og:description, og:image)\r\n- [ ] Twitter Card meta tags are present\r\n- [ ] Page title is branded and descriptive (not \"frontend\")\r\n- [ ] Favicon is updated from placeholder `vite.svg` to a proper branded icon\r\n\r\n## Visual Mockup â€” Google Search Result\r\n\r\n### Before (Current State)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  frontend                                           â”‚\r\nâ”‚  https://ai-dev-request.example.com                 â”‚\r\nâ”‚  No description available for this page.            â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### After (Target State)\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  AI Dev Request â€” Build Software with AI            â”‚\r\nâ”‚  https://ai-dev-request.example.com                 â”‚\r\nâ”‚  Build your own AI site in minutes. Free AI tokens  â”‚\r\nâ”‚  to get started. Describe what you want, and our    â”‚\r\nâ”‚  AI builds it for you. Try AI Dev Request today.    â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Social Media Share Card\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\r\nâ”‚  â”‚                                             â”‚    â”‚\r\nâ”‚  â”‚          [OG Image / Brand Banner]          â”‚    â”‚\r\nâ”‚  â”‚                                             â”‚    â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\r\nâ”‚  AI Dev Request â€” Build Software with AI            â”‚\r\nâ”‚  Build your own AI site with free AI tokens.        â”‚\r\nâ”‚  Describe it, AI builds it.                         â”‚\r\nâ”‚  ai-dev-request.example.com                         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n## Implementation Guidance\r\n\r\n### Primary File: `platform/frontend/index.html`\r\n\r\nAdd the following to `<head>`:\r\n\r\n```html\r\n<!-- Primary Meta Tags -->\r\n<title>AI Dev Request â€” Build Software with AI</title>\r\n<meta name=\"description\" content=\"Build your own AI site in minutes. Free AI tokens to get started. Describe what you want â€” our AI analyzes, proposes, and builds software automatically.\" />\r\n<meta name=\"keywords\" content=\"AI build, AI development, free AI token, build AI site, AI software builder, no-code AI\" />\r\n\r\n<!-- Open Graph / Facebook -->\r\n<meta property=\"og:type\" content=\"website\" />\r\n<meta property=\"og:title\" content=\"AI Dev Request â€” Build Software with AI\" />\r\n<meta property=\"og:description\" content=\"Build your own AI site with free AI tokens. Describe what you want, AI builds it for you.\" />\r\n<meta property=\"og:image\" content=\"/og-image.png\" />\r\n\r\n<!-- Twitter -->\r\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\r\n<meta name=\"twitter:title\" content=\"AI Dev Request â€” Build Software with AI\" />\r\n<meta name=\"twitter:description\" content=\"Build your own AI site with free AI tokens. Describe what you want, AI builds it for you.\" />\r\n<meta name=\"twitter:image\" content=\"/og-image.png\" />\r\n```\r\n\r\n### Additional Files to Create/Update\r\n- `platform/frontend/public/og-image.png` â€” Social sharing image (1200x630px recommended)\r\n- `platform/frontend/public/favicon.ico` â€” Replace placeholder vite.svg with branded favicon\r\n- `platform/frontend/public/robots.txt` â€” Allow search engine crawling\r\n- `platform/frontend/public/sitemap.xml` â€” (optional) Help Google discover pages\r\n\r\n### Keyword Strategy\r\nFocus on these attractive search phrases in the meta description:\r\n- \"AI build\" / \"Build with AI\"\r\n- \"Free AI tokens\"\r\n- \"Build your own AI site\"\r\n- \"No-code AI development\"\r\n- \"AI software builder\"\r\n\r\n## Out of Scope\r\n\r\n- Server-side rendering (SSR) for dynamic SEO\r\n- Google Search Console setup and verification\r\n- Google Ads or paid search campaigns\r\n- Multi-language SEO (i18n meta tags)\r\n- Per-page dynamic meta tags via React Helmet (can be a follow-up)\r\n\r\n## Dependencies\r\n\r\n- Brand assets needed: OG image (1200x630px), favicon\r\n- Final site domain/URL for canonical tags\r\n","number":30,"repository":"bradyoo12/ai-dev-request","title":"Add SEO meta tags for attractive Google search listing","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/30"},"id":"PVTI_lAHNf9fOATn4hM4JPoKX","linked pull requests":["https://github.com/bradyoo12/ai-dev-request/pull/32"],"repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"Add SEO meta tags for attractive Google search listing"},{"content":{"body":"## Original Request\n\n> fix errors\n\n## Problem Statement\n\nThe production site (`icy-desert-07c08ba00.2.azurestaticapps.net`) is completely broken â€” all text displays as raw i18n translation keys (e.g., `hero.title`, `form.label`, `pricing.title`) instead of actual translated content. The browser console shows **multiple 500 errors** from the backend API:\n\n| Failing Endpoint | Status | Impact |\n|------------------|--------|--------|\n| `GET /api/translations/en-AU` | 500 | English (AU) translations not loading |\n| `GET /api/translations/ko` | 500 | Korean translations not loading |\n| `GET /api/translations/en` | 500 | English translations not loading |\n| `GET /api/languages` | 500 | Language selector can't fetch available languages |\n| `GET /settings/tokens` | 500 | Token/pricing settings not loading |\n| `index-ChR3BUiX.css` | 404 | Stylesheet missing (stale asset reference) |\n\nSince all `/api/translations/{locale}` endpoints return 500, `i18next` has no translations to render, causing every `t('key')` call to display the raw key string. The entire site is unusable.\n\n### Screenshot\n\nThe screenshot shows:\n- All visible text is raw translation keys (`hero.title`, `hero.subtitle`, `form.label`, `steps.request.title`, `pricing.title`, `footer.copyright`, etc.)\n- Console tab shows 10+ red 500 errors for translation, language, and settings endpoints\n- One 404 for a CSS asset file\n\n## Root Cause Investigation Areas\n\n1. **Backend server errors (500s)** â€” The .NET 9 API is returning 500 for all translation-related endpoints. Possible causes:\n   - Database connection failure (PostgreSQL not reachable from Azure Container Apps)\n   - Missing database migrations (translations/languages tables may not exist)\n   - Translations not seeded in the production database\n   - Unhandled exception in `TranslationsController` or `LanguagesController`\n   - Environment configuration issue (missing connection string, wrong config)\n\n2. **Locale `en-AU` not supported** â€” The browser detects `en-AU` (Australian English) but this locale may not exist in the database. The backend should either:\n   - Fall back to `en` when a specific regional variant is requested\n   - Return a 404 (not 500) when a locale doesn't exist\n\n3. **CSS 404** â€” The `index-ChR3BUiX.css` file is missing, suggesting a stale deployment where the HTML references an old hashed asset filename.\n\n## Success Criteria\n\n- [ ] All `/api/translations/{locale}` endpoints return 200 with valid translation JSON for supported locales (`ko`, `en`)\n- [ ] `GET /api/languages` returns 200 with the list of active languages\n- [ ] `GET /settings/tokens` returns 200 with token configuration\n- [ ] The site renders all text as translated content (no raw i18n keys visible)\n- [ ] Unsupported locale requests (e.g., `en-AU`) gracefully fall back to base language (`en`) or return a proper 404 â€” not a 500\n- [ ] No stale CSS asset references (404 on stylesheets)\n\n## Implementation Guidance\n\n### 1. Diagnose the 500 errors\n- Check Azure Container Apps logs for the backend service to find the actual exception stack traces\n- Verify the PostgreSQL connection string is correctly configured in production\n- Confirm that EF Core migrations have been applied to the production database\n\n### 2. Fix translation endpoint failures\n- If the database tables are missing: run `dotnet ef database update` or apply migrations\n- If translations aren't seeded: use the `POST /api/translations/seed/{locale}` endpoint or the admin import feature to load `en.json` and `ko.json`\n- Add proper error handling in `TranslationsController.cs` â€” return empty `{}` instead of 500 when a locale has no translations\n\n### 3. Handle unsupported locale variants\n- In `TranslationsController`, when locale like `en-AU` is requested but not found, try the base language code (`en`) before failing\n- Consider adding locale normalization middleware\n\n### 4. Fix stale CSS asset\n- Redeploy the frontend to Azure Static Web Apps so asset hashes match\n- Or investigate if the build output is being properly uploaded\n\n### Key Files\n- `platform/backend/AiDevRequest.API/Controllers/TranslationsController.cs` â€” Translation API\n- `platform/backend/AiDevRequest.API/Controllers/LanguagesController.cs` â€” Language list API\n- `platform/frontend/src/i18n.ts` â€” i18next configuration with backend load path\n- `platform/frontend/src/locales/en.json` â€” English translations (local fallback)\n- `platform/frontend/src/locales/ko.json` â€” Korean translations (local fallback)\n\n## Out of Scope\n\n- Adding new languages beyond `en` and `ko`\n- Redesigning the i18n architecture\n- Admin translation management UI changes\n\n## Dependencies\n\n- Access to Azure Container Apps logs for backend error diagnosis\n- Access to PostgreSQL production database to verify schema and data\n","number":43,"repository":"bradyoo12/ai-dev-request","title":"fix: Backend API returning 500 errors â€” all translations, languages, and settings endpoints broken in production","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/43"},"id":"PVTI_lAHNf9fOATn4hM4JP_9U","repository":"https://github.com/bradyoo12/ai-dev-request","status":"Done","title":"fix: Backend API returning 500 errors â€” all translations, languages, and settings endpoints broken in production"},{"content":{"body":"## Summary\n\nAdd bidirectional GitHub synchronization for AI-generated projects, allowing users to push generated code to their own GitHub repos and pull external changes back into the platform -- similar to how Lovable and Replit handle code ownership in 2026.\n\n## Motivation\n\nThe 2026 AI app builder market has converged on a key insight: **code ownership and exportability are non-negotiable**. Platforms that tried to abstract away code have struggled, while those offering real, exportable code with GitHub sync (Lovable, Replit) are winning market share. Lovable's bidirectional GitHub sync -- where changes in either direction auto-propagate -- is now considered a standard feature.\n\nCurrently, AI Dev Request generates projects but doesn't offer tight integration with users' existing Git workflows. This creates a \"walled garden\" effect that limits adoption among technical founders and developer teams.\n\n## Proposed Feature\n\n### Core Capabilities\n1. **GitHub repo creation**: Auto-create a GitHub repo when a project is generated\n2. **Push sync**: Every AI-generated change commits and pushes to the user's GitHub repo\n3. **Pull sync**: Detect external commits (e.g., from Cursor, VS Code, or manual edits) and pull them into the platform\n4. **Conflict resolution**: AI-assisted merge conflict resolution when platform and external changes diverge\n5. **Branch awareness**: Support working on feature branches, not just the default branch\n\n### Technical Approach\n- Use GitHub App or OAuth + GitHub API for repo management\n- Webhook-based change detection for pull sync\n- Git-based storage layer for generated projects (already generating files; formalize as git repos)\n- Leverage existing `Anthropic.SDK` for AI-assisted conflict resolution\n\n### Integration Points\n- `.NET 9 backend`: New `GitSyncService` with GitHub API client\n- `React frontend`: Repository connection UI, sync status indicators, conflict resolution modal\n- `AI engine`: Conflict resolution prompts\n\n## Competitor Reference\n- **Lovable**: Bidirectional GitHub sync with auto-push/pull on every edit\n- **Replit**: GitHub import/export with collaborative editing\n- **Bolt.new**: One-click GitHub export (but no bidirectional sync)\n\n## Evaluation Scores\n- **Relevance**: 5/5 -- Directly addresses code ownership, a core user need\n- **Impact**: 5/5 -- Differentiator for developer adoption; enables hybrid AI+manual workflows\n- **Effort**: 3/5 -- GitHub API is well-documented; webhook infrastructure needed\n\n## References\n- [Lovable GitHub Integration Docs](https://docs.lovable.dev/integrations/github)\n- [Lovable Review 2026](https://hackceleration.com/lovable-review/)\n- [AI App Builder Trends 2026](https://tech.co/ai/vibe-coding/best-ai-app-builders)","number":47,"repository":"bradyoo12/ai-dev-request","title":"feat: Bidirectional GitHub sync for generated projects (inspired by Lovable)","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/47"},"id":"PVTI_lAHNf9fOATn4hM4JQAXq","labels":["suggestion"],"repository":"https://github.com/bradyoo12/ai-dev-request","title":"feat: Bidirectional GitHub sync for generated projects (inspired by Lovable)"},{"content":{"body":"## Summary\n\nBuild a template marketplace where users can browse, share, and fork pre-built project scaffolds (SaaS starter, e-commerce, CRM, landing page, etc.) to accelerate AI-driven project generation -- similar to ecosystem approaches from Bubble, FlutterFlow, and Base44.\n\n## Motivation\n\nIn 2026, the most successful AI app builders differentiate through their **template and starter ecosystems**. Base44 (acquired by Wix for $80M) grew its user base 7x to 2M+ users partly by offering instant app generation from structured templates. FlutterFlow's AI Gen feature generates entire app templates from text prompts. Bubble's plugin marketplace is the largest in the no-code space.\n\nCurrently, AI Dev Request starts every project from scratch based on the user's natural language prompt. While powerful, this means:\n- Longer generation times for common patterns (e.g., \"build me a SaaS with auth and billing\")\n- Inconsistent architecture across similar projects\n- No way for power users to share proven patterns with the community\n\n## Proposed Feature\n\n### Core Capabilities\n1. **Template library**: Curated collection of project scaffolds (SaaS, e-commerce, blog, dashboard, API-only, mobile app)\n2. **Template-guided generation**: Users select a template as a starting point, then customize via natural language\n3. **Community contributions**: Users can publish their generated projects as templates (with sanitization)\n4. **Template versioning**: Templates evolve with framework updates; users can pin versions\n5. **Template composition**: Combine multiple templates (e.g., \"SaaS starter\" + \"Stripe billing\" + \"Admin dashboard\")\n\n### Technical Approach\n- Template registry as a new database entity (`ProjectTemplate`, `TemplateVersion`, `TemplateCategory`)\n- Templates stored as parameterized project scaffolds in `templates/` directory (already exists in repo)\n- AI engine uses template as context/seed when generating projects\n- Community templates go through automated quality checks before publishing\n\n### Integration Points\n- `.NET 9 backend`: New `TemplateController` and `TemplateService`\n- `React frontend`: Template browser page, template preview, fork/customize flow\n- `AI engine`: Template-aware generation prompts that respect scaffold structure\n- `PostgreSQL`: Template metadata, ratings, download counts\n\n## Competitor Reference\n- **Base44**: Built-in templates for CRM, booking, task tracking\n- **Bubble**: Extensive community plugin/template marketplace\n- **FlutterFlow**: AI Gen for generating from template prompts\n- **Replit**: Template gallery with one-click fork\n\n## Evaluation Scores\n- **Relevance**: 4/5 -- Leverages existing `templates/` directory; natural extension of current architecture\n- **Impact**: 4/5 -- Reduces time-to-value for users; enables community growth flywheel\n- **Effort**: 4/5 -- Template registry is moderate; community features add complexity\n\n## References\n- [Best AI App Builders 2026 - Lindy](https://www.lindy.ai/blog/ai-app-builder)\n- [Base44 AI App Builder Review](https://base44.com/blog/base44-ai-app-builder)\n- [AI App Builder Comparison 2026 - Knack](https://www.knack.com/blog/ai-app-builder-comparison/)","number":48,"repository":"bradyoo12/ai-dev-request","title":"feat: Template marketplace with community-contributed project scaffolds","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/48"},"id":"PVTI_lAHNf9fOATn4hM4JQAYE","labels":["suggestion"],"repository":"https://github.com/bradyoo12/ai-dev-request","title":"feat: Template marketplace with community-contributed project scaffolds"},{"content":{"body":"## Summary\n\nImplement a version control layer for AI-generated projects that gives users visual branching, point-in-time snapshots, and AI-assisted rollback -- enabling safe experimentation with AI changes without fear of losing working states.\n\n## Motivation\n\nThe \"Technical Cliff\" is the #1 problem in 2026 AI app builders: AI generates beautiful code, but one bad prompt can break a working project with no easy way back. As codebases report, \"Version control lets you track and rollback AI modifications when needed\" and \"selective rollback -- when AI introduces bugs, you can surgically remove problematic changes without losing unrelated work.\"\n\nCompetitors are addressing this:\n- **Lovable** auto-commits every AI change to Git with full history\n- **Replit Agent 3** uses checkpoints with effort-based pricing per checkpoint\n- **Bolt.new** has a revision history with restore points\n\nCurrently, AI Dev Request generates projects but provides no built-in versioning. If an AI generation step produces broken code, users have no way to revert to a known-good state without starting over.\n\n## Proposed Feature\n\n### Core Capabilities\n1. **Automatic snapshots**: Every AI generation step creates an immutable snapshot (like Replit checkpoints)\n2. **Visual timeline**: Users see a timeline of all changes with descriptions and diffs\n3. **One-click rollback**: Restore any previous snapshot instantly\n4. **Branching**: Create experimental branches (\"try adding Stripe payments\") without affecting the main project\n5. **AI-assisted rollback**: When something breaks, AI analyzes the diff and suggests which specific changes to revert\n6. **Change attribution**: Clear labeling of AI-generated vs. user-edited changes\n\n### Technical Approach\n- Git-based storage for generated projects (each project is a bare git repo on the server)\n- Snapshots map to git commits with structured metadata (prompt used, files changed, AI model)\n- Branches map to git branches; merging uses AI-assisted conflict resolution\n- Lightweight diff viewer in the frontend using Monaco editor or similar\n- API endpoints for snapshot listing, diff viewing, rollback, and branch management\n\n### Integration Points\n- `.NET 9 backend`: New `VersionControlService` wrapping `LibGit2Sharp` for server-side git operations\n- `React frontend`: Timeline component, diff viewer, branch switcher, rollback confirmation modal\n- `AI engine`: Rollback analysis prompts (\"Given this diff, which changes likely caused the build failure?\")\n- `PostgreSQL`: Snapshot metadata, branch info, rollback audit log\n\n## Competitor Reference\n- **Replit**: Checkpoint system with effort-based pricing per checkpoint\n- **Lovable**: Auto-commits to Git with full history browsable in GitHub\n- **Bolt.new**: Revision history with restore points\n- **Base44**: Discussion mode for safe exploration without affecting live project\n\n## Evaluation Scores\n- **Relevance**: 5/5 -- Directly solves the \"broken generation\" problem users face\n- **Impact**: 4/5 -- Critical safety net; builds user confidence to experiment with AI\n- **Effort**: 3/5 -- LibGit2Sharp/.NET git integration is mature; UI is the main effort\n\n## References\n- [Version Control Best Practices for AI Code](https://www.ranger.net/post/version-control-best-practices-ai-code)\n- [How to Use Version Control with AI Code Generation](https://zenvanriel.nl/ai-engineer-blog/how-to-use-version-control-with-ai-code-generation/)\n- [Replit Effort-Based Pricing (Checkpoint Model)](https://blog.replit.com/effort-based-pricing)\n- [2026 AI Coding Platform Wars](https://medium.com/@aftab001x/the-2026-ai-coding-platform-wars-replit-vs-windsurf-vs-bolt-new-f908b9f76325)","number":49,"repository":"bradyoo12/ai-dev-request","title":"feat: Version-controlled project branching with AI-assisted rollback","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/49"},"id":"PVTI_lAHNf9fOATn4hM4JQAYa","labels":["suggestion"],"repository":"https://github.com/bradyoo12/ai-dev-request","title":"feat: Version-controlled project branching with AI-assisted rollback"},{"content":{"body":"ì• í”Œì™€ì¹˜ë¥¼ ì‚¬ë³¼ê¹Œ í•˜ëŠ” ìƒê°ì— ì• í”ŒìŠ¤í† ì–´ë¥¼ ë“¤ì–´ê°”ëŠ”ë°, ì¢…ë¥˜ê°€ ë§ë‹¤. í•„ìš”ë„ ì—†ëŠ”ë° ë¬´ì¡°ê±´ ë¹„ì‹¼ê±° ê¸°ëŠ¥ë„ ëª¨ë¥¸ì±„ ì‚¬ê¸°ë„ ê·¸ë ‡ê³ , ì‹¼ê±°ìƒ€ë‹¤ê°€ ì‹¤ë§í•˜ê¸´ ì‹«ë‹¤. ìœ ì €ì˜ í‰ì†Œ í–‰ë™ì„ ì˜ ë¶„ì„ ìš”ì•½í•´ë‘ì—ˆë‹¤ê°€ ì§ˆë¬¸ì´ë‚˜ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ê·¸ ì„±í–¥ì— ë§ëŠ” ì¶”ì²œì„ í•´ì¤„ ìˆ˜ìˆëŠ” AI\në§¤ ì§ˆë¬¸ë§ˆë‹¤ ìœ ì €ì˜ preferenceë‚˜ ì„±í–¥ì´ detectë˜ë©´ ë°”ë¡œ ê¸°ë¡í•´ë‘ì–´ ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ì¤€ë¹„ë¥¼ í•´ë‘”ë‹¤. Vector search ë“±ì„ ì‚¬ìš©í•˜ì—¬ ì…ì¶œë ¥ì–‘ì„ ìµœì†Œë¡œ","number":53,"repository":"bradyoo12/ai-dev-request","title":"Core: personalized","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/53"},"id":"PVTI_lAHNf9fOATn4hM4JQCvZ","repository":"https://github.com/bradyoo12/ai-dev-request","title":"Core: personalized"},{"content":{"body":"AI appì´ ë§ì•„ì§ì— ë”°ë¼ A2Aë¡œ í†µì‹ ì´ í•„ìš”í•˜ë‹¤.\n\nAiê±´ê°•ê´€ë¦¬ ì•±ì˜ outputì€ ë‹¹ë‡¨ í˜ˆì•• ì¡°ì‹¬ ìŒì‹ë“±ì˜ personalized aiì‹ë‹¨ê´€ë¦¬ ì•±ì—ê²Œ í•„ìš”í•˜ë‹¤. ë‘ aiê°€ í•„ìš”ì— ë”°ë¼ í†µì‹ ì„ ì¤€ë¹„. ì¸ì¦ ë‹¨ê³„ í•„ìš”","number":54,"repository":"bradyoo12/ai-dev-request","title":"A2A í”„ë¡œí† ì½œ","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/54"},"id":"PVTI_lAHNf9fOATn4hM4JQC8V","repository":"https://github.com/bradyoo12/ai-dev-request","title":"A2A í”„ë¡œí† ì½œ"},{"content":{"body":"## Original Request\n\n> AIì™€ì˜ ëŒ€í™”ì¤‘ì— ì‚¬ëŒë“¤ì´ ë¬¸ì˜ë¥¼ í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ì—…ê·¸ë ˆì´ë“œ ì¶”ê°€ê°€ í•„ìš”í•œ ê¸€ì„ ì“°ë©´ AIê°€ ì¢‹ì€ ìƒê°ì„ì„ ì¹­ì°¬í•˜ê³  ë¬¸ì˜/ì œì•ˆ ê²Œì‹œíŒì— ë“±ë¡ì„ ì‚¬ìš©ìì—ê²Œ 'ì¢‹ì€ ìƒê°ì…ë‹ˆë‹¤. ë§ì”€í•˜ì‹  ë‚´ìš©ì„ ë¬¸ì˜ê²Œì‹œíŒì— ë“±ë¡í• ê¹Œìš”?' í™•ì¸í›„ ë“±ë¡. ê¸°ì—¬ë„ì— ë”°ë¼ í¬ë ˆë”§ í† í°ìœ¼ë¡œ ë³´ë‹µ.\n\n---\n\n## Problem Statement\n\nCurrently, when users interact with the AI during the refinement chat, they sometimes share valuable suggestions, feature ideas, or inquiries that go unrecorded. These user insights are lost once the conversation ends. There is no mechanism for the AI to recognize user contributions, capture them formally, or reward users for their input.\n\nWe need a system where the AI can:\n1. **Detect** when a user's message contains a suggestion, feature request, or inquiry\n2. **Acknowledge** the idea with positive feedback\n3. **Offer** to register it on a suggestion/inquiry board with user confirmation\n4. **Reward** the user with credit tokens based on contribution quality\n\n---\n\n## Success Criteria\n\n- [ ] AI detects suggestion/inquiry intent in user messages during refinement chat\n- [ ] AI responds with praise and a confirmation prompt (\"ì¢‹ì€ ìƒê°ì…ë‹ˆë‹¤! ë§ì”€í•˜ì‹  ë‚´ìš©ì„ ë¬¸ì˜ê²Œì‹œíŒì— ë“±ë¡í• ê¹Œìš”?\")\n- [ ] User can confirm or decline the registration via inline buttons\n- [ ] Confirmed suggestions are saved to a new `Suggestions` table with status tracking\n- [ ] A public **Suggestion Board** page displays all registered suggestions\n- [ ] Users can upvote/comment on suggestions\n- [ ] Token rewards are credited upon suggestion registration (base reward)\n- [ ] Bonus tokens awarded when suggestions receive community upvotes (contribution-based scaling)\n- [ ] Suggestion author's contribution history is visible on their profile\n- [ ] All token transactions for suggestion rewards appear in the existing token history\n\n---\n\n## Implementation Guidance\n\n### 1. AI Intent Detection (Refinement Chat)\n\nExtend the refinement chat system prompt in `RefinementService.cs` to detect suggestion/inquiry patterns. When detected, the AI should respond with structured output:\n\n```\n{\n  \"type\": \"suggestion_detected\",\n  \"category\": \"feature_request\" | \"inquiry\" | \"bug_report\" | \"improvement\",\n  \"summary\": \"...\",\n  \"praise_message\": \"...\",\n  \"confirmation_prompt\": \"...\"\n}\n```\n\n### 2. Suggestion Board (New Feature)\n\n**Backend:**\n- New `Suggestion` entity with fields: title, description, category, status (pending/approved/implemented/closed), author, upvote count, token reward\n- New `SuggestionVote` entity for upvoting\n- New `SuggestionsController` with CRUD + vote endpoints\n- Integration with existing `TokenService` for rewards\n\n**Frontend:**\n- New Suggestion Board page accessible from main navigation\n- Inline confirmation UI in `RefinementChat.tsx`\n\n### 3. Token Reward Tiers\n\n| Action | Token Reward |\n|--------|-------------|\n| Suggestion registered | 50 tokens |\n| Suggestion gets 10+ upvotes | +100 bonus tokens |\n| Suggestion gets 50+ upvotes | +300 bonus tokens |\n| Suggestion implemented | +500 bonus tokens |\n\n---\n\n## Visual Mockups\n\n### Chat Flow - Suggestion Detection\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Refinement Chat                                    â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                     â”‚\nâ”‚  ğŸ‘¤ User:                                           â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\nâ”‚  â”‚ ë‹¤êµ­ì–´ ì§€ì›ì´ ìˆìœ¼ë©´ ì¢‹ê² ì–´ìš”. ì˜ì–´ë‘        â”‚    â”‚\nâ”‚  â”‚ ì¼ë³¸ì–´ë„ ìë™ìœ¼ë¡œ ë²ˆì—­í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ìš”.       â”‚    â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\nâ”‚                                                     â”‚\nâ”‚  ğŸ¤– AI:                                             â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\nâ”‚  â”‚ ğŸ’¡ ì¢‹ì€ ìƒê°ì…ë‹ˆë‹¤! ë‹¤êµ­ì–´ ìë™ ë²ˆì—­ ê¸°ëŠ¥ì€  â”‚    â”‚\nâ”‚  â”‚ ë§ì€ ì‚¬ìš©ìë“¤ì—ê²Œ ë„ì›€ì´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.     â”‚    â”‚\nâ”‚  â”‚                                              â”‚    â”‚\nâ”‚  â”‚ ë§ì”€í•˜ì‹  ë‚´ìš©ì„ ì œì•ˆ ê²Œì‹œíŒì— ë“±ë¡í• ê¹Œìš”?    â”‚    â”‚\nâ”‚  â”‚ ë“±ë¡í•˜ì‹œë©´ 50 í† í°ì´ ë³´ìƒìœ¼ë¡œ ì§€ê¸‰ë©ë‹ˆë‹¤! ğŸ â”‚    â”‚\nâ”‚  â”‚                                              â”‚    â”‚\nâ”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚\nâ”‚  â”‚  â”‚ âœ… ë„¤, ë“±ë¡  â”‚  â”‚ âŒ ì•„ë‹ˆìš”    â”‚          â”‚    â”‚\nâ”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\nâ”‚                                                     â”‚\nâ”‚  ğŸ¤– AI (after confirm):                             â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\nâ”‚  â”‚ âœ… ì œì•ˆì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤! 50 í† í°ì´          â”‚    â”‚\nâ”‚  â”‚ ì§€ê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ™               â”‚    â”‚\nâ”‚  â”‚                                              â”‚    â”‚\nâ”‚  â”‚ ğŸ“‹ ì œì•ˆ #142: ë‹¤êµ­ì–´ ìë™ ë²ˆì—­ ê¸°ëŠ¥          â”‚    â”‚\nâ”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚    â”‚\nâ”‚  â”‚ ìƒíƒœ: ê²€í† ì¤‘ | ì¹´í…Œê³ ë¦¬: ê¸°ëŠ¥ ì œì•ˆ           â”‚    â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\nâ”‚                                                     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Suggestion Board Page\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  ğŸ  Home    ğŸ“‹ Suggestion Board    âš™ Settings    ğŸ‘¤ Profile â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                             â”‚\nâ”‚  ğŸ’¡ ì œì•ˆ ê²Œì‹œíŒ                          [âœï¸ ìƒˆ ì œì•ˆ ì‘ì„±]  â”‚\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚\nâ”‚                                                             â”‚\nâ”‚  Filter: [ì „ì²´ â–¼]  [ìµœì‹ ìˆœ â–¼]   ğŸ” ê²€ìƒ‰...                 â”‚\nâ”‚                                                             â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\nâ”‚  â”‚  ğŸ”¼                                                 â”‚    â”‚\nâ”‚  â”‚  47   ğŸ’¡ ë‹¤êµ­ì–´ ìë™ ë²ˆì—­ ê¸°ëŠ¥                      â”‚    â”‚\nâ”‚  â”‚  ğŸ”½   by @user123 Â· 2ì¼ ì „ Â· ğŸ· ê¸°ëŠ¥ ì œì•ˆ          â”‚    â”‚\nâ”‚  â”‚       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚    â”‚\nâ”‚  â”‚       ì˜ì–´, ì¼ë³¸ì–´ ìë™ ë²ˆì—­ ì§€ì› ì¶”ê°€ ìš”ì²­         â”‚    â”‚\nâ”‚  â”‚       ìƒíƒœ: ğŸŸ¡ ê²€í† ì¤‘        ğŸ’¬ 12 ëŒ“ê¸€             â”‚    â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\nâ”‚                                                             â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\nâ”‚  â”‚  ğŸ”¼                                                 â”‚    â”‚\nâ”‚  â”‚  23   ğŸ› ëª¨ë°”ì¼ì—ì„œ ì½”ë“œ ë¯¸ë¦¬ë³´ê¸° ê¹¨ì§              â”‚    â”‚\nâ”‚  â”‚  ğŸ”½   by @devfan Â· 5ì¼ ì „ Â· ğŸ· ë²„ê·¸ ë¦¬í¬íŠ¸         â”‚    â”‚\nâ”‚  â”‚       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚    â”‚\nâ”‚  â”‚       ëª¨ë°”ì¼ í™”ë©´ì—ì„œ ì½”ë“œ í”„ë¦¬ë·° ë ˆì´ì•„ì›ƒ ë¬¸ì œ     â”‚    â”‚\nâ”‚  â”‚       ìƒíƒœ: ğŸŸ¢ êµ¬í˜„ ì™„ë£Œ      ğŸ’¬ 8 ëŒ“ê¸€             â”‚    â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\nâ”‚                                                             â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\nâ”‚  â”‚  ğŸ”¼                                                 â”‚    â”‚\nâ”‚  â”‚  15   â“ API ì—°ë™ ì‹œ ì¸ì¦ ë°©ì‹ ë¬¸ì˜                 â”‚    â”‚\nâ”‚  â”‚  ğŸ”½   by @newbie Â· 1ì£¼ ì „ Â· ğŸ· ë¬¸ì˜                â”‚    â”‚\nâ”‚  â”‚       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚    â”‚\nâ”‚  â”‚       ì™¸ë¶€ API ì—°ë™ ì‹œ OAuth vs API Key ë¬¸ì˜        â”‚    â”‚\nâ”‚  â”‚       ìƒíƒœ: ğŸ”µ ë‹µë³€ ì™„ë£Œ      ğŸ’¬ 5 ëŒ“ê¸€             â”‚    â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\nâ”‚                                                             â”‚\nâ”‚  â—€ 1  2  3  ... 12 â–¶                                       â”‚\nâ”‚                                                             â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Token Reward Flow (Settings Page Integration)\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  ğŸ’° í† í° ë‚´ì—­                                       â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                     â”‚\nâ”‚  ë‚ ì§œ         í•­ëª©              í† í°    ì”ì•¡         â”‚\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚\nâ”‚  02/07 14:32  ğŸ’¡ ì œì•ˆ ë“±ë¡ ë³´ìƒ   +50   1,250       â”‚\nâ”‚  02/07 14:30  ğŸ”§ Refinement Chat  -10   1,200       â”‚\nâ”‚  02/06 09:15  ğŸ‰ ì œì•ˆ 10+ ì¶”ì²œ    +100  1,210       â”‚\nâ”‚  02/05 11:00  â­ ì œì•ˆ êµ¬í˜„ ë³´ìƒ   +500  1,110       â”‚\nâ”‚  02/04 16:45  ğŸ“Š Analysis         -50     610       â”‚\nâ”‚                                                     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## Out of Scope\n\n- Admin moderation dashboard for suggestions (future ticket)\n- AI auto-categorization accuracy tuning (iterative improvement)\n- Suggestion-to-DevRequest auto-conversion pipeline\n- Public API for external suggestion submission\n- Gamification beyond token rewards (badges, leaderboards)\n\n---\n\n## Dependencies\n\n- Existing token system (`TokenService.cs`, `TokenBalance`, `TokenTransaction`)\n- Existing refinement chat (`RefinementService.cs`, `RefinementChat.tsx`)\n- Existing database context (`AiDevRequestDbContext.cs`)\n\n---\n\n## Technical Notes\n\n- Suggestion detection should be done via Claude system prompt enhancement â€” no separate ML model needed\n- Token rewards integrate with the existing `TokenService.CreditTokens()` method\n- The suggestion board should follow the same UI patterns as `MySitesPage.tsx` (card-based layout with shadcn/ui)\n- New DB migration required for `Suggestions` and `SuggestionVotes` tables\n","number":55,"repository":"bradyoo12/ai-dev-request","title":"feat: AI-driven suggestion detection in chat with board registration and token rewards","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/55"},"id":"PVTI_lAHNf9fOATn4hM4JQFJh","repository":"https://github.com/bradyoo12/ai-dev-request","status":"Ready","title":"feat: AI-driven suggestion detection in chat with board registration and token rewards"},{"content":{"body":"## Original Request\r\n\r\n> êµ¬ë… ìƒí’ˆ ìœ ì €ìˆ˜ë¥¼ ì˜ ìœ ì§€í•˜ëŠ” ê¸°ë¡í•˜ëŠ” ë¹„ì§€ë‹ˆìŠ¤ëŠ” ë¯¸ë˜ê°€ ë°ë‹¤. Churn Rateë¥¼ ê¸°ë¡í•˜ê³  í™•ì¸í•  ìˆ˜ ìˆëŠ” admin í˜ì´ì§€ë¥¼ ë§Œë“¤ì–´ë¼\r\n\r\n## Problem Statement\r\n\r\nCurrently, we have subscription plans defined (`Subscription.cs` - Free/Starter/Pro/Enterprise) and a token-based billing system with Stripe integration, but there is **no way to track subscriber retention or churn**. We cannot answer critical business questions:\r\n\r\n- How many active subscribers do we have per plan?\r\n- What is our monthly/weekly churn rate?\r\n- When and why are users downgrading or canceling?\r\n- What is our revenue trend over time (MRR)?\r\n\r\nWithout churn tracking, we're flying blind on the most important SaaS metric. A business that records and monitors subscription user retention has a bright future â€” we need this visibility now.\r\n\r\n## Success Criteria\r\n\r\n- [ ] **Subscription lifecycle tracking**: Record subscription events (created, upgraded, downgraded, canceled, renewed, reactivated) in the database\r\n- [ ] **Churn Rate calculation**: Calculate and display monthly churn rate (canceled subscribers / total subscribers at start of period Ã— 100)\r\n- [ ] **Admin Dashboard page**: New `/admin/churn` page showing churn metrics with charts\r\n- [ ] **Key metrics displayed**: Active subscribers count, MRR (Monthly Recurring Revenue), monthly churn rate, net subscriber growth\r\n- [ ] **Historical trend charts**: Line charts showing churn rate and subscriber count over time (last 6-12 months)\r\n- [ ] **Plan-level breakdown**: Churn rate segmented by subscription plan (Free â†’ Paid churn, Starter, Pro, Enterprise)\r\n- [ ] **Churn event log**: Searchable/filterable table of recent subscription changes with user info, old plan, new plan, and timestamp\r\n- [ ] **Revenue impact**: Show revenue lost from churned subscribers per period\r\n\r\n## Implementation Guidance\r\n\r\n### Database Layer\r\n\r\n**New Entities needed:**\r\n\r\n1. `SubscriptionRecord` â€” tracks active subscriptions per user\r\n   - UserId, PlanType, Status (Active/Canceled/Paused), StartedAt, CanceledAt, ExpiresAt\r\n\r\n2. `SubscriptionEvent` â€” audit log of all subscription lifecycle events\r\n   - UserId, EventType (Created/Upgraded/Downgraded/Canceled/Renewed/Reactivated), FromPlan, ToPlan, Reason, CreatedAt\r\n\r\n3. `ChurnMetricSnapshot` â€” periodic snapshots for fast dashboard loading\r\n   - PeriodStart, PeriodEnd, TotalSubscribers, NewSubscribers, ChurnedSubscribers, ChurnRate, MRR, NetGrowth\r\n\r\n### Backend API\r\n\r\nNew `AdminChurnController` under `/api/admin/churn`:\r\n\r\n| Endpoint | Purpose |\r\n|----------|---------|\r\n| `GET /api/admin/churn/overview` | Current metrics (active subs, MRR, current churn rate) |\r\n| `GET /api/admin/churn/trends?months=12` | Historical trend data for charts |\r\n| `GET /api/admin/churn/by-plan` | Churn breakdown by subscription plan |\r\n| `GET /api/admin/churn/events?page=1&size=20` | Paginated subscription event log |\r\n| `GET /api/admin/churn/export` | CSV export of churn data |\r\n\r\n### Frontend\r\n\r\nNew admin page at `platform/frontend/src/pages/admin/ChurnDashboard.tsx` following existing admin page pattern from `LanguageManagement.tsx`.\r\n\r\n### ASCII Mockup\r\n\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  Admin > Churn Dashboard                                        [Export CSV]â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚                                                                             â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\r\nâ”‚  â”‚ Active Subs  â”‚  â”‚  Churn Rate  â”‚  â”‚     MRR      â”‚  â”‚  Net Growth  â”‚   â”‚\r\nâ”‚  â”‚    1,247     â”‚  â”‚    3.2%      â”‚  â”‚  â‚©48,350,000 â”‚  â”‚   +42        â”‚   â”‚\r\nâ”‚  â”‚  â–² +5.1%     â”‚  â”‚  â–¼ -0.8%    â”‚  â”‚  â–² +12.3%    â”‚  â”‚  â–² vs -12    â”‚   â”‚\r\nâ”‚  â”‚  vs last mo  â”‚  â”‚  vs last mo  â”‚  â”‚  vs last mo  â”‚  â”‚  last month  â”‚   â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\r\nâ”‚                                                                             â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\r\nâ”‚  â”‚  Churn Rate & Subscriber Trend (Last 12 Months)                     â”‚   â”‚\r\nâ”‚  â”‚  [Churn Rate â–¾] [Subscribers â–¾] [MRR â–¾]                            â”‚   â”‚\r\nâ”‚  â”‚                                                                     â”‚   â”‚\r\nâ”‚  â”‚  5% â”‚                                                    1,300      â”‚   â”‚\r\nâ”‚  â”‚     â”‚    â•­â”€â•®                                             1,200      â”‚   â”‚\r\nâ”‚  â”‚  4% â”‚   â•±   â•²                                            1,100      â”‚   â”‚\r\nâ”‚  â”‚     â”‚  â•±     â•²    â•­â”€â•®                                    1,000      â”‚   â”‚\r\nâ”‚  â”‚  3% â”‚ â•±       â•²â”€â”€â•±   â•²â”€â”€â•®                                 900      â”‚   â”‚\r\nâ”‚  â”‚     â”‚â•±                   â•²â”€â”€â•®                              800      â”‚   â”‚\r\nâ”‚  â”‚  2% â”‚                       â•²â”€â”€â•®  â•­â”€â”€                     700      â”‚   â”‚\r\nâ”‚  â”‚     â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ (subs)     600      â”‚   â”‚\r\nâ”‚  â”‚  1% â”‚                                                     500      â”‚   â”‚\r\nâ”‚  â”‚     â”œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”            â”‚   â”‚\r\nâ”‚  â”‚     Mar Apr May Jun Jul Aug Sep Oct Nov Dec Jan Feb               â”‚   â”‚\r\nâ”‚  â”‚                                                                     â”‚   â”‚\r\nâ”‚  â”‚  â”€â”€ Churn Rate    â–‘â–‘ Active Subscribers                             â”‚   â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\r\nâ”‚                                                                             â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\r\nâ”‚  â”‚  Churn by Plan                                                      â”‚   â”‚\r\nâ”‚  â”‚                                                                     â”‚   â”‚\r\nâ”‚  â”‚  Plan         â”‚ Active â”‚ Churned â”‚ Churn Rate â”‚ Revenue Lost        â”‚   â”‚\r\nâ”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚   â”‚\r\nâ”‚  â”‚  Free         â”‚   820  â”‚   45    â”‚   5.5%     â”‚  â‚©0                 â”‚   â”‚\r\nâ”‚  â”‚  Starter      â”‚   312  â”‚    8    â”‚   2.6%     â”‚  â‚©392,000           â”‚   â”‚\r\nâ”‚  â”‚  Pro          â”‚    98  â”‚    2    â”‚   2.0%     â”‚  â‚©298,000           â”‚   â”‚\r\nâ”‚  â”‚  Enterprise   â”‚    17  â”‚    0    â”‚   0.0%     â”‚  â‚©0                 â”‚   â”‚\r\nâ”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚   â”‚\r\nâ”‚  â”‚  Total        â”‚ 1,247  â”‚   55    â”‚   3.2%     â”‚  â‚©690,000           â”‚   â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\r\nâ”‚                                                                             â”‚\r\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\r\nâ”‚  â”‚  Recent Subscription Events                                         â”‚   â”‚\r\nâ”‚  â”‚  [Filter: All â–¾] [Plan: All â–¾] [Date Range: Last 30 days â–¾]       â”‚   â”‚\r\nâ”‚  â”‚                                                                     â”‚   â”‚\r\nâ”‚  â”‚  Time          â”‚ User            â”‚ Event     â”‚ From    â†’ To         â”‚   â”‚\r\nâ”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚   â”‚\r\nâ”‚  â”‚  2 hours ago   â”‚ kim@email.com   â”‚ Canceled  â”‚ Starter â†’ Free      â”‚   â”‚\r\nâ”‚  â”‚  5 hours ago   â”‚ park@email.com  â”‚ Upgraded  â”‚ Free    â†’ Pro       â”‚   â”‚\r\nâ”‚  â”‚  1 day ago     â”‚ lee@email.com   â”‚ Renewed   â”‚ Pro     â†’ Pro       â”‚   â”‚\r\nâ”‚  â”‚  1 day ago     â”‚ choi@email.com  â”‚ Downgrade â”‚ Pro     â†’ Starter   â”‚   â”‚\r\nâ”‚  â”‚  2 days ago    â”‚ jung@email.com  â”‚ Created   â”‚ -       â†’ Starter   â”‚   â”‚\r\nâ”‚  â”‚                                                                     â”‚   â”‚\r\nâ”‚  â”‚  â—€ 1 2 3 ... 12 â–¶                                     20 per page â”‚   â”‚\r\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\r\nâ”‚                                                                             â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Key Formulas\r\n\r\n```\r\nMonthly Churn Rate = (Churned Subscribers in Period / Total Subscribers at Start of Period) Ã— 100\r\nMRR = Î£ (Active Subscribers Ã— Plan Monthly Price)\r\nNet Growth = New Subscribers - Churned Subscribers\r\nRevenue Churn = Î£ (Churned Subscriber Plan Prices) / MRR at Start Ã— 100\r\n```\r\n\r\n### Existing Patterns to Follow\r\n\r\n- **Admin page pattern**: Follow `platform/frontend/src/pages/admin/LanguageManagement.tsx` for page structure\r\n- **API pattern**: Follow existing controllers like `SettingsController` for paginated endpoints\r\n- **Entity pattern**: Follow `Payment.cs` entity with enums for event types\r\n- **DbContext**: Add new DbSets to `AiDevRequestDbContext.cs`\r\n- **Charts**: Use recharts (already available in React ecosystem) or similar lightweight chart library\r\n\r\n## Out of Scope\r\n\r\n- Automated churn prevention (email alerts, win-back campaigns)\r\n- Cohort analysis (can be added later)\r\n- A/B testing subscription pricing\r\n- Predictive churn modeling (ML-based)\r\n- Real-time webhook-driven updates (polling/refresh is fine for v1)\r\n- Admin authentication/RBAC (separate ticket â€” currently no admin auth exists)\r\n\r\n## Dependencies\r\n\r\n- Subscription plan enforcement must be integrated first (plans are defined in `Subscription.cs` but not yet enforced in the app flow)\r\n- Stripe webhook handler (`WebhooksController.cs`) should emit subscription events when payments succeed/fail\r\n- Consider adding admin role to User entity for future admin page protection\r\n\r\n## Technical Notes\r\n\r\n- Existing entities: `Subscription.cs` (plan definitions), `Payment.cs` (Stripe payments), `User.cs`\r\n- Existing admin page: `platform/frontend/src/pages/admin/LanguageManagement.tsx`\r\n- DbContext: `platform/backend/AiDevRequest.API/Data/AiDevRequestDbContext.cs`\r\n- Frontend uses: React 18 + TypeScript + shadcn/ui + Tailwind CSS + Zustand\r\n- Backend: .NET 9, PostgreSQL, EF Core\r\n","number":56,"repository":"bradyoo12/ai-dev-request","title":"feat: add Churn Rate tracking admin dashboard","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/56"},"id":"PVTI_lAHNf9fOATn4hM4JQFLE","repository":"https://github.com/bradyoo12/ai-dev-request","status":"Ready","title":"feat: add Churn Rate tracking admin dashboard"},{"content":{"body":"## Bug Description\n\nClicking the \"Login\" button in the header causes the entire React app to crash with a blank white screen.\n\n## Error\n\n```\nMinified React error #300: \"Rendered fewer hooks than expected\"\n```\n\n## Root Cause\n\nIn `platform/frontend/src/App.tsx`, the early return on line 56-58:\n\n```tsx\nif (showLogin) {\n  return <LoginPage onLogin={handleLogin} onSkip={() => setShowLogin(false)} />\n}\n```\n\nis placed **before** the `useCallback` (line 193) and `useEffect` (line 202) hooks. This violates React's rules of hooks â€” hooks must be called unconditionally and in the same order on every render.\n\n## Steps to Reproduce\n\n1. Open https://icy-desert-07c08ba00.2.azurestaticapps.net\n2. Click the \"Login\" button in the header\n3. App crashes to blank white screen\n\n## Expected Behavior\n\nLogin page should render with email/password form fields.\n\n## Fix\n\nMove the `if (showLogin)` early return to after all hook declarations (after line 204), or refactor to use conditional rendering in the JSX instead of an early return.\n\n## Related\n\n- #33 (email/password auth feature - backend works, this is a frontend-only issue)\n\nFound during b-review staging verification.","number":59,"repository":"bradyoo12/ai-dev-request","title":"bug: Login button crashes app (React error #300 - hooks ordering)","type":"Issue","url":"https://github.com/bradyoo12/ai-dev-request/issues/59"},"id":"PVTI_lAHNf9fOATn4hM4JQFyB","labels":["bug"],"repository":"https://github.com/bradyoo12/ai-dev-request","title":"bug: Login button crashes app (React error #300 - hooks ordering)"}],"totalCount":27}
